import{SessionToken as e,featureToSuggestion as t,ValidationCore as s,MatchCodeConfidence as i,debounce as n,AddressAutofillCore as r,SearchSession as a,SearchBoxCore as o,LngLatBounds as l,LngLat as h,Evented as c}from"@mapbox/search-js-core";import{offset as d,flip as u,computePosition as p,autoUpdate as m}from"@floating-ui/dom";import v from"no-scroll";import{createFocusTrap as f}from"focus-trap";import g from"subtag";import b from"@mapbox/sphericalmercator";var w=Object.defineProperty;var M=Object.defineProperties;var k=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty;var S=Object.prototype.propertyIsEnumerable;var __defNormalProp=(e,t,s)=>t in e?w(e,t,{enumerable:true,configurable:true,writable:true,value:s}):e[t]=s;var __spreadValues=(e,t)=>{for(var s in t||(t={}))x.call(t,s)&&__defNormalProp(e,s,t[s]);if(y)for(var s of y(t))S.call(t,s)&&__defNormalProp(e,s,t[s]);return e};var __spreadProps=(e,t)=>M(e,k(t));var __accessCheck=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)};var __privateGet=(e,t,s)=>{__accessCheck(e,t,"read from private field");return s?s.call(e):t.get(e)};var __privateAdd=(e,t,s)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,s)};var __privateSet=(e,t,s,i)=>{__accessCheck(e,t,"write to private field");i?i.call(e,s):t.set(e,s);return s};var __privateMethod=(e,t,s)=>{__accessCheck(e,t,"access private method");return s};var __async=(e,t,s)=>new Promise(((i,n)=>{var fulfilled=e=>{try{step(s.next(e))}catch(e){n(e)}};var rejected=e=>{try{step(s.throw(e))}catch(e){n(e)}};var step=e=>e.done?i(e.value):Promise.resolve(e.value).then(fulfilled,rejected);step((s=s.apply(e,t)).next())}));var A=document.implementation.createHTMLDocument();function bindElements(e,t){const s={};for(const[i,n]of Object.entries(t))s[i]=e.querySelector(n);return s}function getChildElements(e){return Array.from(e.childNodes||[]).filter((e=>e.nodeType===Node.ELEMENT_NODE))}function createElementFromString(e){const t=document.createElement("template");t.innerHTML=e;return t.content.firstElementChild}function createCSSStyleSheet(e){const t=A.createElement("style");t.textContent=e;A.head.appendChild(t);return t.sheet}function isVisible(e){const t=window.getComputedStyle(e);return"none"!==t.display}function setValue(e,t){if(!e)return;const s=Object.getOwnPropertyDescriptor(e.constructor.prototype,"value").set;s.call(e,t);const i=e;i._valueTracker&&i._valueTracker.setValue("");const n=new Event("input",{bubbles:true});n.simulated=true;e.dispatchEvent(n);const r=new Event("change",{bubbles:true});r.simulated=true;e.dispatchEvent(r)}function getElementSize(e,t=false){let s;let i;const n=e.getBoundingClientRect();if("none"===e.style.display||0===n.height&&0===n.width){const n=e.cloneNode(t);e.parentElement.appendChild(n);n.style.setProperty("display","block","important");const r=n.getBoundingClientRect();s=r.width;i=r.height;n.style.setProperty("display","none");n.remove()}else{s=n.width;i=n.height}return{height:Math.floor(i),width:Math.floor(s)}}function addDocumentStyle(e){const t=document.createElement("style");t.innerHTML=e;document.head.appendChild(t)}var E=new RegExp("[_a-zA-Z]+[_a-zA-Z0-9-]*","g");var C=new RegExp(`\\.${E.source}`,"g");var T=new RegExp("^\\s*(@(?:media|supports)[^{]*){(.*)}\\s*$");function transformClassSelectors(e,t){return e.replace(C,(e=>"."+t(e.slice(1))))}function transformCSSClassRules(e,t){const s=createCSSStyleSheet(e);const i=s.cssRules;function transformCSSRule(e){if(e instanceof CSSStyleRule){const s=transformClassSelectors(e.selectorText,t);return`${s} { ${e.style.cssText} }`}const s=T.exec(e.cssText.split("\n").join(""));if(s&&s.length>2){const e=s[1];const i=s[2];return`${e} { ${transformCSSClassRules(i,t)} }`}return e.cssText}let n="";for(const e of Array.from(i))n+=transformCSSRule(e)+"\n\n";return n.trim()}function transformDOMClassAttributes(e,t){const s=Array.from(e.querySelectorAll("[class]"));s.push(e);for(const e of s){const{classList:s}=e;for(const e of Array.from(s)){s.remove(e);s.add(t(e))}}return e}var B=1.4;function bboxViewport(e,t,s=.5){const{center:i,zoom:n}=e.cameraForBounds(t);const r=Math.max(n-s,0);return{center:i,zoom:r,speed:B}}function getMaxZoom(e){switch(e){case"street":return 15;case"neighborhood":case"postcode":case"locality":case"oaza":return 14;case"place":case"city":return 13;case"district":return 9;case"region":case"prefecture":return 6;case"country":return 4;default:return 16}}function getStaticBaseUrl(e,t){return`https://api.mapbox.com/styles/v1/${e}/${t}/static/`}var W='<svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.8 3.8a1 1 0 0 1 1.4 0L9 7.58l3.8-3.8a1 1 0 1 1 1.4 1.42L10.42 9l3.8 3.8a1 1 0 0 1-1.42 1.4L9 10.42l-3.8 3.8a1 1 0 0 1-1.4-1.42L7.58 9l-3.8-3.8a1 1 0 0 1 0-1.4Z" fill="currentColor"/></svg>';var L='<svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg"><path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/></svg>';var I=getStaticBaseUrl("mapbox","satellite-streets-v11");var F="20d01";var j=["mapbox.com","mapbox.cn","tilestream.net"];var O=createElementFromString('\n<template>\n  <div class="MapboxSearch">\n    <div class="Label" role="label" aria-live="polite" aria-atomic="true">\n    </div>\n    <div class="Results" aria-hidden="true">\n      <div class="ResultsList" role="listbox">\n      </div>\n      <div class="ResultsAttribution" aria-hidden="true">\n        <a href="https://www.mapbox.com/search-service" target="_blank" tabindex="-1">\n          Powered by Mapbox\n        </a>\n      </div>\n    </div>\n  </div>\n</template>\n');var P=createElementFromString('\n<template>\n  <div class="Suggestion" role="option" tabindex="-1">\n    <div class="SuggestionIcon" aria-hidden="true"></div>\n    <div class="SuggestionText">\n      <div class="SuggestionName"></div>\n      <div class="SuggestionDesc"></div>\n    </div>\n  </div>\n</template>\n');var R=createElementFromString(`\n<template>\n  <div class="SearchBox">\n    <div class="SearchIcon"></div>\n    <input class="Input" type="text" />\n    <div class="ActionIcon">\n      <button aria-label="Clear" class="ClearBtn">${W}</button>\n      <div class="LoadingIcon">${L}</div>\n    </div>\n  </div>\n</template>\n`);function randomValidID(){return"mbx"+(new e).id.slice(0,8)}function tryParseJSON(e){try{return JSON.parse(e)}catch(e){return null}}function deepEquals(e,t){if(null==e||null==t)return e===t;if("object"!==typeof e||"object"!==typeof t)return e===t;const s=Object.keys(e);const i=Object.keys(t);if(s.length!==i.length)return false;for(const i of s)if(!deepEquals(e[i],t[i]))return false;return true}function round(e,t){const s=Math.pow(10,t);return Math.round(e*s)/s}function isLocalServer(e){return Boolean(e.match(/localhost|[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}|::1|\.local|^$/gi))}function isMapboxDomain(e){return Boolean(j.some((t=>e.includes(t))))}var $,D,_;var H=class extends HTMLElement{constructor(){super(...arguments);__privateAdd(this,$,randomValidID());__privateAdd(this,D,void 0);__privateAdd(this,_,(e=>`${__privateGet(this,$)}--${e}`))}get template(){return null}get templateStyle(){return null}get templateUserStyle(){return null}clonedCallback(e,t){const seedTransform=s=>s.replace(e,t);transformDOMClassAttributes(this,seedTransform);const s=Array.from(this.querySelectorAll("style"));for(const e of s)e.textContent=transformClassSelectors(e.textContent,seedTransform);s.length&&__privateSet(this,D,s[s.length-1]);const i=Array.from(this.querySelectorAll(`[id^="${e}"]`));for(const s of i)s.id=s.id.replace(e,t)}connectedCallback(){if(this.childElementCount>0){const e=this.dataset.seed;const t=__privateGet(this,$);if(e&&e!==t){this.clonedCallback(e,t);this.dataset.seed=t}return}this.dataset.seed=__privateGet(this,$);const e=this.template;if(e){const t=this.prepareTemplate(e);this.appendChild(t)}const t=this.templateStyle;if(t){const e=document.createElement("style");e.textContent=this.prepareCSS(t);this.appendChild(e)}const s=document.createElement("style");this.templateUserStyle&&(s.textContent=this.prepareCSS(this.templateUserStyle));this.appendChild(s);__privateSet(this,D,s)}prepareTemplate(e){const t=e.content.firstElementChild;return transformDOMClassAttributes(t.cloneNode(true),__privateGet(this,_))}prepareCSS(e){return transformCSSClassRules(e,__privateGet(this,_))}updateTemplateUserStyle(e){__privateGet(this,D)&&(__privateGet(this,D).textContent=this.prepareCSS(e))}querySelector(e){return super.querySelector(transformClassSelectors(e,__privateGet(this,_)))}querySelectorAll(e){return super.querySelectorAll(transformClassSelectors(e,__privateGet(this,_)))}addEventListener(e,t,s){super.addEventListener(e,t,s)}removeEventListener(e,t,s){super.removeEventListener(e,t,s)}dispatchEvent(e){return super.dispatchEvent(e)}};$=new WeakMap;D=new WeakMap;_=new WeakMap;var z='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M9 16A7 7 0 1 0 9 2a7 7 0 0 0 0 14ZM6.88 4.88a2.58 2.58 0 0 1 1.83-.75h1.08a2.58 2.58 0 0 1 2.59 2.58v.16c0 1-.53 1.94-1.4 2.46l-.56.34c-.27.16-.45.42-.52.71-.03.14-.14.25-.28.25H8.38a.23.23 0 0 1-.24-.25c.08-.91.59-1.74 1.38-2.21l.56-.34c.34-.2.54-.57.54-.96V6.7a.83.83 0 0 0-.83-.83H8.71a.83.83 0 0 0-.84.83v.18a.87.87 0 1 1-1.75 0V6.7c0-.69.28-1.34.76-1.83ZM10 13a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z" fill="currentColor"/></svg>';var q='<svg width="48" height="56" fill="none" xmlns="http://www.w3.org/2000/svg"><g filter="url(#a)"><path d="m24 50.4 13.79-14.12a18.82 18.82 0 0 0 4.23-20.86 19.23 19.23 0 0 0-7.19-8.6 19.76 19.76 0 0 0-21.66 0c-3.21 2.11-5.71 5.1-7.19 8.6a18.82 18.82 0 0 0 4.23 20.86L24 50.4Z" fill="currentColor"/><path d="M37.26 35.75 24 49.34 10.75 35.76l-.01-.01A18.07 18.07 0 0 1 6.68 15.7a18.48 18.48 0 0 1 6.9-8.26 19 19 0 0 1 20.84 0 18.48 18.48 0 0 1 6.9 8.26 18.07 18.07 0 0 1-4.06 20.04Z" stroke="#fff" stroke-width="1.5"/></g><circle cx="24" cy="22.45" fill="#fff" r="5.85"/><defs><filter id="a" x=".5" y=".6" width="47" height="54.8" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset dy="1"/><feGaussianBlur stdDeviation="2"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_17_871"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_17_871" result="shape"/></filter></defs></svg>';var V='<svg width="24" height="24" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M1.08 14.94 5.625 3.06h1.17l-3.42 11.88H1.08Zm15.885 0L12.42 3.06h-1.17l3.42 11.88h2.295Zm-6.86-1.44H7.946l.128-2.61h1.912l.119 2.61Zm-.217-4.77H8.181l.088-1.8h1.537l.082 1.8ZM9.74 5.49h-1.4l.049-.99h1.306l.045.99Z" fill="currentColor" />\n</svg>';var N='\x3c!-- TODO: I\'m not sure if the way I added the circle will "scale" properly, need to check that --\x3e\n<svg width="24" height="24" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">\n  <path fill="none" stroke="currentColor" stroke-width="1.5" d="M4 7a5 5 0 1 1 10 0c0 3.025-3.28 6.713-5 9-1.72-2.287-5-5.975-5-9z"></path>\n    <circle cx="9" cy="7" r="2" fill="currentColor"></circle>\n</svg>';var Y='<svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>\n</svg>';var X="1.0.0-beta.18";var U=`https://api.mapbox.com/search-js/v${X}/img/style-toggle-satellite.jpg`;var Z=`https://api.mapbox.com/search-js/v${X}/img/style-toggle-default.jpg`;var Q=767;var J=`@media only screen and (max-width: ${Q}px)`;var K={variables:{unit:["mobile","16px","14px"],unitHeader:["mobile","24px","18px"],minWidth:"min(300px, 100vw)",spacing:"0.75em",padding:"0.5em 0.75em",paddingFooterLabel:"0.5em 0.75em",paddingModal:"1.25em",colorText:"rgba(0, 0, 0, 0.75)",colorPrimary:"#4264FB",colorSecondary:"#667F91",colorBackground:"#fff",colorBackgroundHover:"#f5f5f5",colorBackgroundActive:"#f0f0f0",colorBackdrop:"rgba(102, 127, 145, 0.3)",border:"none",borderRadius:"4px",boxShadow:"\n      0 0 10px 2px rgba(0, 0, 0, 0.05),\n      0 0 6px 1px rgba(0, 0, 0, 0.1),\n      0 0 0 1px rgba(0, 0, 0, 0.1)\n    ",lineHeight:"1.2em",fontFamily:"\n      -apple-system, BlinkMacSystemFont,\n      avenir next, avenir,\n      segoe ui,\n      helvetica neue, helvetica,\n      Ubuntu, roboto, noto, arial, sans-serif\n    ",fontWeight:"normal",fontWeightSemibold:"600",fontWeightBold:"bold",duration:"150ms",curve:"ease-out"},icons:{close:W,question:z,marker:q,street:V,addressMarker:N,search:Y},images:{styleToggleDefault:Z,styleToggleSatellite:U}};function getThemeCSS(e,t={}){const s=__spreadValues(__spreadValues({},K.variables),t.variables||{});let i=t.cssText||"";let n="";for(const[t,r]of Object.entries(s)){if(!Array.isArray(r)){n+=`--${t}: ${r};`;continue}if("mobile"!==r[0]){const e=JSON.stringify(r);throw new Error(`Unsupported expression in theme variables: ${t} ${e}`)}const[,s,a]=r;i+=`${J} { ${e} { --${t}: ${s} !important; } }`;n+=`--${t}: ${a};`}return i+`${e} { ${n} }`}function getIcon(e,t={}){const s=__spreadValues(__spreadValues({},K.icons),t.icons||{});const i=s[e];return i}function getImage(e,t={}){const s=__spreadValues(__spreadValues({},K.images),t.images||{});const i=s[e];return i}var G,ee;var te=class{constructor(e,t,s){__privateAdd(this,G,void 0);__privateAdd(this,ee,{placement:"bottom-start",flip:false,offset:10});this.update=()=>__async(this,null,(function*(){const e={placement:this.options.placement,middleware:[d(this.options.offset),this.options.flip&&u()].filter(Boolean)};const{x:t,y:s}=yield p(this.referenceEl,this.floatingEl,e);Object.assign(this.floatingEl.style,{left:`${t}px`,top:`${s}px`})}));this.referenceEl=e;this.floatingEl=t;__privateSet(this,G,__spreadValues(__spreadValues({},__privateGet(this,ee)),s));this.destroy=m(this.referenceEl,this.floatingEl,this.update)}get options(){return __privateGet(this,G)}set options(e){__privateSet(this,G,__spreadValues(__spreadValues({},__privateGet(this,G)),e))}};G=new WeakMap;ee=new WeakMap;var se="*{box-sizing:border-box!important}[role=button]{cursor:pointer}.MapboxSearch{--width:0;display:none}.Results{background-color:var(--colorBackground);border:var(--border);border-radius:var(--borderRadius);box-shadow:var(--boxShadow);color:var(--colorText);font-family:var(--fontFamily);font-size:var(--unit);font-weight:var(--fontWeight);line-height:var(--lineHeight);min-width:var(--minWidth);overflow-y:auto;position:absolute;transform:translateZ(0);transition:visibility var(--duration);width:var(--width);z-index:1000}.Results:not([aria-hidden=true]){visibility:visible}.Results[aria-hidden=true]{animation:fadein var(--duration) var(--curve) reverse forwards;visibility:hidden}.Suggestion{align-items:center;display:flex;padding:var(--padding)}.Suggestion:hover{cursor:pointer}.Suggestion[aria-selected=true]{background-color:var(--colorBackgroundHover)}.Suggestion:active{background-color:var(--colorBackgroundActive)}.SuggestionName{font-weight:var(--fontWeightBold)}.SuggestionIcon{margin-right:6px}.SuggestionIcon[aria-hidden=true]{display:none}.ResultsAttribution{padding:var(--paddingFooterLabel)}.ResultsAttribution a{color:var(--colorSecondary)}.ResultsAttribution a:not(:hover){text-decoration:none}.ResultsList{list-style:none;margin:0;padding:0}.Label{display:none}.SearchBox{background-color:var(--colorBackground);border:var(--border);border-radius:var(--borderRadius);box-shadow:var(--boxShadow);color:var(--colorText);font-family:var(--fontFamily);font-size:var(--unit);font-weight:var(--fontWeight);line-height:var(--lineHeight);padding:var(--padding);padding-bottom:0;padding-top:0;position:relative;width:100%}.SearchIcon{fill:#757575;left:.5em}.ActionIcon,.SearchIcon{bottom:0;height:20px;margin:auto 0;position:absolute;top:0;width:20px}.ActionIcon{right:.5em}.ActionIcon>button{background:none;border:none;color:inherit;cursor:pointer;font:inherit;height:100%;outline:inherit;padding:0;width:100%}.ActionIcon>button:hover{background:none!important}.ClearBtn{display:none}.ClearBtn:hover{color:#909090}.LoadingIcon{-moz-animation:rotate .8s cubic-bezier(.45,.05,.55,.95) infinite;-webkit-animation:rotate .8s cubic-bezier(.45,.05,.55,.95) infinite;animation:rotate .8s cubic-bezier(.45,.05,.55,.95) infinite;display:none;height:100%}@-webkit-keyframes rotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes rotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.Input{background-color:transparent;border:0;color:#404040;color:rgba(0,0,0,.75);font:inherit;height:36px;margin:0;overflow:hidden;padding:0 40px;text-overflow:ellipsis;white-space:nowrap;width:100%}.Input::-ms-clear{display:none}.Input:focus{border:thin dotted;border-radius:var(--borderRadius);box-shadow:none;color:#404040;color:rgba(0,0,0,.75);outline:0}mapbox-address-confirmation-feature[aria-hidden=true],mapbox-address-confirmation-no-feature[aria-hidden=true]{display:none}.MapboxAddressConfirmation{align-items:center;background-color:var(--colorBackdrop);bottom:0;display:flex;justify-content:center;left:0;position:fixed;right:0;top:0;transform:translateZ(0);z-index:1000}.MapboxAddressConfirmation:not([aria-hidden=true]){animation:fadein var(--duration) var(--curve) forwards;visibility:visible}.MapboxAddressConfirmation[aria-hidden=true]{visibility:hidden}.ContentFeature,.ContentNoFeature{width:var(--minWidth)}.Modal{background-color:var(--colorBackground);border:var(--border);border-radius:var(--borderRadius);box-shadow:var(--boxShadow);color:var(--colorText);font-family:var(--fontFamily);font-size:var(--unit);font-weight:var(--fontWeight);line-height:var(--lineHeight);padding:var(--paddingModal);width:100%}@media screen and (max-width:480px){.MapboxAddressConfirmation{align-items:flex-end}.ContentFeature,.ContentNoFeature{width:100%}.Modal{border-bottom-left-radius:0;border-bottom-right-radius:0}}.ModalHeader{align-items:center;color:var(--colorPrimary);display:flex;font-size:var(--unitHeader);font-weight:var(--fontWeightBold);margin-bottom:var(--spacing);user-select:none;width:100%}.ModalMap{height:calc(var(--minWidth)*9/16);margin-left:calc(var(--paddingModal)*-1);width:calc(100% + var(--paddingModal)*2)}.ModalMap[aria-hidden=true]{display:none}.Icon{height:var(--unitHeader);width:var(--unitHeader)}.Icon.IconClose{color:var(--colorSecondary)}.ModalHeaderTitle{flex:1;margin-left:.25em}.ModalFooter{color:var(--colorSecondary);margin-top:var(--spacing);text-align:center}.ModalFooter[aria-hidden=true]{display:none}.ModalSubheader{font-weight:var(--fontWeightBold);user-select:none}.ModalDescription{color:var(--colorPrimary)}.ModalAddress,.ModalSubheader{margin-bottom:var(--spacing)}.ModalAddress.ModalAddressApprove{color:var(--colorPrimary)}.Button{border-radius:var(--borderRadius);cursor:pointer;font-weight:var(--fontWeightSemibold);margin-top:var(--spacing);padding:var(--padding);text-align:center;user-select:none;width:100%}.Button[aria-hidden=true]{display:none}.Button.ButtonPrimary{background-color:var(--colorPrimary);color:var(--colorBackground)}.Button.ButtonSecondary{border:1px solid var(--colorSecondary);color:var(--colorSecondary)}@keyframes fadein{0%{opacity:0}to{opacity:1}}.MapboxAddressMinimap{font-family:var(--fontFamily);font-size:var(--unit);font-weight:var(--fontWeight);line-height:var(--lineHeight)}.MapboxAddressMinimap[aria-hidden=true]{display:none}.MinimapImageContainer{border-radius:var(--borderRadius);overflow:hidden}.MinimapImage{height:unset;max-height:unset;max-width:unset;position:relative;width:unset}.MinimapInnerFrame{border:var(--border);border-radius:inherit;height:inherit;left:0;overflow:hidden;position:absolute;top:0;width:inherit}.MinimapMarker{left:50%;position:absolute;top:50%}.MinimapMarker>svg{color:var(--colorPrimary);display:block!important}.MinimapAttributionLogo{bottom:0;left:0;margin:0 0 6px 6px;position:absolute}.MinimapAttributionLogo a{cursor:pointer;display:block;height:23px;width:88px}.MinimapAttributionText{background-color:hsla(0,0%,100%,.65);bottom:0;font:11px/16px Helvetica Neue,Arial,Helvetica,sans-serif;padding:0 5px;position:absolute;right:0}.MinimapAttributionText a{color:rgba(0,0,0,.75);text-decoration:none}.MinimapAttributionText a:hover{color:inherit;text-decoration:underline}.MinimapAttributionText a:not(:first-child){margin-left:3px}.MinimapStyleToggle{background-position:0;background-repeat:no-repeat;background-size:contain;border:2px solid #fff;border-radius:3px;box-shadow:var(--boxShadow);cursor:pointer;height:2em;position:absolute;right:var(--spacing);top:var(--spacing);width:2em}.MinimapFooter{color:var(--colorSecondary);font-family:var(--fontFamily);font-size:var(--unit);margin-top:var(--spacing)}.MinimapFooter[aria-hidden=true]{display:none}.MinimapEditButtons{bottom:26px;display:flex;font-family:var(--fontFamily);position:absolute;right:var(--spacing)}.MinimapEditButtons .Button{box-shadow:var(--boxShadow)}.MinimapButtonCancel{background-color:var(--colorBackground);margin-left:var(--spacing)}.draggable{cursor:move;cursor:grab}.draggable:active{cursor:grabbing}";var ie=class extends CustomEvent{constructor(e,t){super(e,{composed:true,detail:t})}clone(e){const t=new ie(this.type,this.detail);e&&Object.defineProperty(t,"target",{value:e});return t}};var ne="Type in 2 or more characters for results.";var re="When autocomplete results are available use up and down arrows to review and enter to select. Touch device users, explore by touch or with swipe gestures.";var ae="No search results.";var getSuggestionSelectedMessage=(e,t,s)=>`${t} ${1===t?"result is":"results are"} available. ${e}. ${s} of ${t} is selected.`;var getSuggestionsReadyMessage=e=>`${e} ${1===e?"result is":"results are"} available. Use up and down arrows to review and enter to select. Touch device users, explore by touch or with swipe gestures.`;function ariaButtonKeyDown(e){const t=e.currentTarget;if(" "===e.key||"Enter"===e.key){e.preventDefault();e.stopPropagation();t.dispatchEvent(new MouseEvent("click",{bubbles:true,composed:true}))}}var oe="search-listbox__description";var createAriaLiveElement=e=>{const t=document.createElement("div");t.setAttribute("aria-live","polite");t.setAttribute("aria-atomic","true");t.setAttribute("role","status");t.setAttribute("style","border: 0px;clip: rect(0px, 0px, 0px, 0px);height: 1px;margin-bottom: -1px;margin-right: -1px;overflow: hidden;padding: 0px;position: absolute;white-space: nowrap;width: 1px;");const s=document.createElement("div");s.setAttribute("id",`${e}--${oe}`);t.appendChild(s);return t};var setLiveRegionMessage=(e,t)=>{var s;const i=null!=(s=document.body.querySelector(`[id="${t}--${oe}"]`))?s:null;i&&(i.textContent=e)};var suppressExtensionsAutocomplete=e=>{e.name=e.name+" address-search";e.setAttribute("data-lpignore","true")};var getAriaMessage=(e,t,s)=>{let i=null;const n=!t||0===t.length;if((null==e?void 0:e.length)<2)i=ne+" "+re;else if(n)i=ae;else if(void 0!==s){const e=t[s];const n=e.address||e.full_address||e.feature_name;i=getSuggestionSelectedMessage(n,t.length,s+1)}else i=getSuggestionsReadyMessage(t.length);return i};var getSuggestionTitle=(e,t)=>{switch(t){case 0:return e.address_line1||e.matching_name||e.feature_name;case 3:return e.name;case 1:return e.place_name.split(",")[0];default:return""}};var buildSuggestionDescription=(e,t)=>{switch(t){case 0:return e.description;case 3:return"poi"===e.feature_type?e.full_address:e.place_formatted;case 1:return e.place_name.split(",").splice(1).join(",").trim();default:return""}};function getAriaIdForSuggestion(e,t){return`${e}-${t}`}var le,he,ce,de,ue,pe,me,ve,fe,ge,be,we,Me,ke,ye,xe,Se,Ae;var Ee=class extends H{constructor(){super(...arguments);__privateAdd(this,ve);__privateAdd(this,ge);this.suggestions=null;__privateAdd(this,le,null);__privateAdd(this,he,void 0);__privateAdd(this,ce,void 0);__privateAdd(this,de,void 0);__privateAdd(this,ue,void 0);__privateAdd(this,pe,null);__privateAdd(this,me,void 0);__privateAdd(this,we,{});__privateAdd(this,Me,{});__privateAdd(this,ke,(e=>{const{Results:t}=__privateGet(this,he);const s=e.target;if(s.dataset.mapboxSuccess){delete s.dataset.mapboxSuccess;return}const i=s.value;this.renderAriaMessage();t.setAttribute("aria-busy","true");this.dispatchEvent(new ie("input",i))}));this.renderAriaMessage=()=>{var e;const t=getAriaMessage(null==(e=this.input)?void 0:e.value,this.suggestions,this.selectedIndex);setLiveRegionMessage(t,this.dataset.seed)};this.clearAriaMessage=()=>{setLiveRegionMessage("",this.dataset.seed)};this.handleSuggest=e=>{this.suggestions=e;e&&0!==e.length||this.renderAriaMessage();if(!e){this.hideResults();return}__privateMethod(this,ge,be).call(this);e.length&&__privateMethod(this,ve,fe).call(this);const{Results:t}=__privateGet(this,he);t.setAttribute("aria-busy","false")};this.handleError=()=>{const{Results:e}=__privateGet(this,he);e.setAttribute("aria-busy","false");this.hideResults()};__privateAdd(this,ye,(e=>__async(this,null,(function*(){const t=this.input;t&&(t.dataset.mapboxSuccess="true");this.dispatchEvent(new ie("select",e));this.hideResults()}))));__privateAdd(this,xe,(()=>{const e=this.input;delete e.dataset.mapboxSuccess;this.dispatchEvent(new ie("focus"));this.renderAriaMessage();__privateMethod(this,ve,fe).call(this)}));__privateAdd(this,Se,(()=>{if(document.activeElement!==this.input){this.dispatchEvent(new ie("blur"));this.clearAriaMessage();this.hideResults()}}));this.handleArrowUp=()=>{void 0===this.selectedIndex?this.selectedIndex=this.suggestions.length-1:0===this.selectedIndex?this.selectedIndex=void 0:this.selectedIndex=Math.max(0,this.selectedIndex-1)};this.handleArrowDown=()=>{void 0===this.selectedIndex?this.selectedIndex=0:this.selectedIndex===this.suggestions.length-1?this.selectedIndex=void 0:this.selectedIndex=Math.min(this.selectedIndex+1,this.suggestions.length-1)};__privateAdd(this,Ae,(e=>{var t;if(null==(t=this.suggestions)?void 0:t.length)if("ArrowDown"!==e.key)if("ArrowUp"!==e.key)if("Escape"!==e.key){if(void 0!==this.selectedIndex)if("Tab"!==e.key)if("Enter"!==e.key);else{e.preventDefault();__privateGet(this,ye).call(this,this.suggestions[this.selectedIndex])}else __privateGet(this,ye).call(this,this.suggestions[this.selectedIndex])}else this.hideResults();else{e.preventDefault();this.handleArrowUp()}else{e.preventDefault();this.handleArrowDown()}}))}get template(){return O}get templateStyle(){return se}get templateUserStyle(){return getThemeCSS(".MapboxSearch",this.theme)}get input(){return __privateGet(this,ue)}set input(e){const t=__privateGet(this,ue);if(t){t.removeEventListener("input",__privateGet(this,ke));t.removeEventListener("focus",__privateGet(this,xe));t.removeEventListener("blur",__privateGet(this,Se));t.removeEventListener("keydown",__privateGet(this,Ae));__privateGet(this,le)&&__privateGet(this,le).destroy()}if(e){e.addEventListener("input",__privateGet(this,ke));e.addEventListener("focus",__privateGet(this,xe));e.addEventListener("blur",__privateGet(this,Se));e.addEventListener("keydown",__privateGet(this,Ae));e.setAttribute("role","combobox");e.setAttribute("aria-autocomplete","list");e.setAttribute("aria-controls",__privateGet(this,de));this.isConnected&&__privateSet(this,le,new te(e,__privateGet(this,he).Results,this.popoverOptions))}__privateSet(this,ue,e)}get searchService(){return __privateGet(this,pe)}set searchService(e){__privateSet(this,pe,e)}get selectedIndex(){return __privateGet(this,me)}set selectedIndex(e){const t=__privateGet(this,me);__privateSet(this,me,e);const{ResultsList:s}=__privateGet(this,he);const i=getAriaIdForSuggestion(__privateGet(this,de),e);if(void 0!==e){this.input.setAttribute("aria-activedescendant",i);s.setAttribute("aria-activedescendant",i)}else{this.input.removeAttribute("aria-activedescendant");s.removeAttribute("aria-activedescendant")}if(t!==e){const n=getAriaIdForSuggestion(__privateGet(this,de),t);const r=s.querySelector(`#${n}`);null==r?void 0:r.removeAttribute("aria-selected");null==r?void 0:r.setAttribute("tabindex","-1");if(void 0!==e){const e=s.querySelector(`#${i}`);null==e?void 0:e.setAttribute("aria-selected","true");null==e?void 0:e.setAttribute("tabindex","0")}}this.renderAriaMessage()}hideResults(){const{Results:e,ResultsList:t}=__privateGet(this,he);e.setAttribute("aria-hidden","true");this.input.setAttribute("aria-expanded","false");t.removeAttribute("aria-activedescendant");this.input.removeAttribute("aria-activedescendant")}renderItem(e){const t=this.prepareTemplate(P);t.id=getAriaIdForSuggestion(__privateGet(this,de),e);return t}fillItem(e,t,s,i){const n=e.querySelector('[class$="SuggestionIcon"]');const r=e.querySelector('[class$="SuggestionName"]');const a=e.querySelector('[class$="SuggestionDesc"]');if(0===this.searchService){n.innerHTML=getIcon("street"===t.accuracy?"street":"addressMarker",this.theme);n.removeAttribute("aria-hidden")}else n.setAttribute("aria-hidden","true");r.textContent=a.textContent="";r.textContent=getSuggestionTitle(t,this.searchService);a.textContent=buildSuggestionDescription(t,this.searchService);s===this.selectedIndex?e.setAttribute("aria-selected","true"):e.removeAttribute("aria-selected");e.setAttribute("aria-posinset",(s+1).toString());e.setAttribute("aria-setsize",i.toString())}get theme(){return __privateGet(this,we)}set theme(e){__privateSet(this,we,e);__privateGet(this,he)&&e&&this.updateTemplateUserStyle(getThemeCSS(".MapboxSearch",e))}get popoverOptions(){return __privateGet(this,Me)}set popoverOptions(e){__privateSet(this,Me,e);if(__privateGet(this,le)){__privateGet(this,le).options=e;__privateGet(this,le).update()}}connectedCallback(){super.connectedCallback();this.dataSeed=this.dataset.seed;__privateSet(this,ce,this.dataset.seed+"-Label");__privateSet(this,de,this.dataset.seed+"-ResultsList");this.input&&this.input.setAttribute("aria-controls",__privateGet(this,de));__privateSet(this,he,bindElements(this,{MapboxSearch:".MapboxSearch",Results:".Results",ResultsList:".ResultsList",Label:".Label"}));const{Results:e,ResultsList:t,Label:s}=__privateGet(this,he);s.id=__privateGet(this,ce);t.id=__privateGet(this,de);t.setAttribute("aria-labelledby",__privateGet(this,ce));e.addEventListener("blur",__privateGet(this,Se));!__privateGet(this,le)&&this.input&&__privateSet(this,le,new te(this.input,__privateGet(this,he).Results,this.popoverOptions));requestAnimationFrame((()=>{__privateGet(this,le)&&__privateGet(this,le).update()}))}disconnectedCallback(){this.input=null;const{Results:e}=__privateGet(this,he);e.removeEventListener("blur",__privateGet(this,Se));__privateGet(this,le)&&__privateGet(this,le).destroy()}focus(){document.activeElement===this.input?__privateGet(this,xe).call(this):this.input.focus()}blur(){this.input.blur()}updatePopover(){__privateGet(this,le)&&__privateGet(this,le).update()}};le=new WeakMap;he=new WeakMap;ce=new WeakMap;de=new WeakMap;ue=new WeakMap;pe=new WeakMap;me=new WeakMap;ve=new WeakSet;fe=function(){if(!this.suggestions||!this.suggestions.length)return;const{Results:e,MapboxSearch:t}=__privateGet(this,he);const s=this.input.getBoundingClientRect();t.style.setProperty("--width",`${s.width}px`);t.style.setProperty("display","block");this.input.setAttribute("aria-expanded","true");e.removeAttribute("aria-hidden");this.selectedIndex=void 0};ge=new WeakSet;be=function(){const{ResultsList:e}=__privateGet(this,he);if(!this.suggestions||!this.suggestions.length){e.innerHTML="";this.hideResults();return}const t=getChildElements(e);if(this.suggestions.length>t.length)for(let s=t.length;s<this.suggestions.length;s++){const i=this.renderItem(s);t.push(i);i.onmouseenter=()=>{this.selectedIndex=s};i.onmouseleave=()=>{this.selectedIndex=void 0};e.appendChild(i)}if(this.suggestions.length<t.length)for(let e=this.suggestions.length;e<t.length;e++)t[e].remove();for(const e of this.suggestions){const s=this.suggestions.indexOf(e);const i=t[s];this.fillItem(i,e,s,this.suggestions.length);i.onclick=()=>{__privateGet(this,ye).call(this,e)}}};we=new WeakMap;Me=new WeakMap;ke=new WeakMap;ye=new WeakMap;xe=new WeakMap;Se=new WeakMap;Ae=new WeakMap;window.MapboxSearchListbox=Ee;window.customElements.get("mapbox-search-listbox")||customElements.define("mapbox-search-listbox",Ee);var Ce=new Set(["street-address","address-line1","address-line2","address-line3","address-level4","address-level3","address-level2","address-level1","country","country-name","postal-code"]);var Te=new Set(["off","on","true","false"]);function findParentForm(e){let t=e.parentNode;while(t){if(t instanceof HTMLFormElement)return t;t=t.parentNode}return null}function findAddressInputs(e){const t=e||document;return Array.from(t.querySelectorAll('input[autocomplete~="address-line1"], input[autocomplete~="street-address"]'))}var Be="section-";var We="section-default";var Le="section-shipping";var Ie="section-billing";function parseFormStructure(e){const t=Array.from(e.querySelectorAll("[autocomplete]")).filter((e=>{const t=e.tagName.toLowerCase();return"input"===t||"select"===t||"textarea"===t}));const s=[];for(const e of t){if(!isVisible(e))continue;const t=e.getAttribute("autocomplete")||"";if(!t||Te.has(t))continue;const i=t.toLowerCase().split(" ");if(i.length>3)continue;const n=i[i.length-1];if(!Ce.has(n))continue;i.pop();let r=We;if(i.length){const e=i[i.length-1];if("shipping"===e){r=Le;i.pop()}if("billing"===e){r=Ie;i.pop()}}if(i.length){const e=i[i.length-1];e.startsWith(Be)&&(r=e)}s.push({input:e,section:r,field:n})}return s}function findAddressAutofillInputs(e,t){const s=[];const i=[];const n=parseFormStructure(e);let r=null;for(const{input:e,section:a,field:o}of n){let n=s.length-1;let l=false;s.length?(i[n]!==a||s[n][o])&&(l=true):l=true;if(l){if(r)break;s.push({[o]:e});i.push(a);n++}else s[n][o]=e;e===t&&(r=s[n])}return null!=r?r:{}}function setFormAutofillValues(e,t,s){var i;const n=findAddressAutofillInputs(e,t);const r=[s.address_line1,s.address_line2,s.address_line3].filter((e=>Boolean(e))).join(", ");setValue(n["street-address"],r);setValue(n["address-line1"],s.address_line1||"");setValue(n["address-level1"],s.address_level1||"");setValue(n["address-level2"],s.address_level2||"");setValue(n["address-level3"],s.address_level3||"");const a=s.country_code||(null==(i=s.metadata)?void 0:i.iso_3166_1)||"";if(n.country&&n.country instanceof HTMLSelectElement){const e=n.country.querySelector("option").value;const t=e===e.toUpperCase();setValue(n.country,t?a.toUpperCase():a)}else setValue(n.country,a);setValue(n["country-name"],s.country||"");setValue(n["postal-code"],s.postcode||"")}function getFormAutofillValues(e,t){const s=findAddressAutofillInputs(e,t);const i={};for(const[e,t]of Object.entries(s))(null==t?void 0:t.value)&&(i[e]=t.value);return i}function getAutofillSearchText(e){const t=[];if(e["street-address"])t.push(e["street-address"]);else{t.push(e["address-line1"]||"");t.push(e["address-line2"]||"");t.push(e["address-line3"]||"")}t.push(e["address-level3"]||"");t.push(e["address-level2"]||"");t.push(e["address-level1"]||"");t.push(e["postal-code"]||"");e["country-name"]?t.push(e["country-name"]):t.push(e.country||"");return t.filter((e=>Boolean(e))).map((e=>e.trim())).join(", ")}function fillFormWithFeature(e,s){const i=findParentForm(s);if(!i)return;const n=t(e);setFormAutofillValues(i,s,n);const r=findAddressAutofillInputs(i,s);r["address-line2"]&&r["address-line2"].focus()}function featureToAutofillValueMap(e){var t;const s={};const i=[e.properties.address_line1,e.properties.address_line2,e.properties.address_line3].filter((e=>Boolean(e))).join(", ");s["street-address"]=i;s["address-line1"]=e.properties.address_line1;s["address-line2"]=e.properties.address_line2;s["address-line3"]=e.properties.address_line3;s["address-level1"]=e.properties.address_level1;s["address-level2"]=e.properties.address_level2;s["address-level3"]=e.properties.address_level3;s.country=null==(t=e.properties.metadata)?void 0:t.iso_3166_1;s["country-name"]=e.properties.country;s["postal-code"]=e.properties.postcode;return s}function checkAutofillValuesChanged(e,t){for(const[s,i]of Object.entries(e))if(t[s]!==i)return true;return false}var distinctExactStreetResults=e=>e.filter(((e,t,s)=>{const i=getSuggestionTitle(e,0);return"street"!==e.accuracy||s.findIndex((e=>i===getSuggestionTitle(e,0)))===t}));var toggleAutocompletion=(e,t,s)=>{const i="new-password";const n="address-line1";const r=s?t||n:i;e&&(e.autocomplete=r)};var handleStreetSelection=(e,t,s)=>{if(!e||!s)return;toggleAutocompletion(e,t,true);const i={properties:__spreadProps(__spreadValues({},s),{address_line1:s.address_line1+" ",postcode:null})};fillFormWithFeature(i,e);toggleAutocompletion(e,t,false);null==e?void 0:e.focus()};var Fe=class{constructor(){this.feedbackEnabled=true;this.autofillSessionToken=new e;this.autofillSessionEnabled=false;this.detectBrowserAutofillEnabled=false}};var je=new Fe;Object.defineProperty(je,"autofillSessionToken",{configurable:false,writable:false});var Oe=createElementFromString('\n<template>\n  <div class="MapboxAddressConfirmation" aria-hidden="true">\n    <mapbox-address-confirmation-feature class="ContentFeature"></mapbox-address-confirmation-feature>\n    <mapbox-address-confirmation-no-feature class="ContentNoFeature"></mapbox-address-confirmation-no-feature>\n  </div>\n</template>\n');var Pe,Re,$e,De;var _e=class extends H{constructor(){super(...arguments);__privateAdd(this,Pe,false);__privateAdd(this,Re,void 0);__privateAdd(this,$e,void 0);__privateAdd(this,De,{})}get template(){return Oe}get templateStyle(){return se}get templateUserStyle(){return getThemeCSS(".MapboxAddressConfirmation",this.theme)}get theme(){return __privateGet(this,De)}set theme(e){__privateSet(this,De,e);if(!__privateGet(this,Re)||!e)return;this.updateTemplateUserStyle(getThemeCSS(".MapboxAddressConfirmation",e));const{ContentFeature:t,ContentNoFeature:s}=__privateGet(this,Re);t.theme=e;s.theme=e}connectedCallback(){super.connectedCallback();__privateSet(this,Re,bindElements(this,{MapboxAddressConfirmation:".MapboxAddressConfirmation",ContentFeature:".ContentFeature",ContentNoFeature:".ContentNoFeature"}));const{MapboxAddressConfirmation:e}=__privateGet(this,Re);e.setAttribute("aria-hidden","true");const t=this.theme;if(t){const{ContentFeature:e,ContentNoFeature:s}=__privateGet(this,Re);e.theme=t;s.theme=t}}disconnectedCallback(){__privateSet(this,$e,null)}hide(){var e;__privateSet(this,Pe,false);if(!__privateGet(this,Re))return;const{MapboxAddressConfirmation:t}=__privateGet(this,Re);t.setAttribute("aria-hidden","true");null==(e=__privateGet(this,$e))?void 0:e.deactivate();v.off()}show(e,t,s){return __async(this,null,(function*(){var i;if(!__privateGet(this,Re))return{type:"cancel"};const{MapboxAddressConfirmation:n,ContentFeature:r,ContentNoFeature:a}=__privateGet(this,Re);const{accessToken:o,minimap:l=false,theme:h,footer:c}=t;this.theme=h;if(s){r.removeAttribute("aria-hidden");a.setAttribute("aria-hidden","true");r.minimap=l;r.accessToken=o;r.footer=c;r.update(s,e)}else{r.setAttribute("aria-hidden","true");a.removeAttribute("aria-hidden");a.update(e)}__privateSet(this,Pe,true);n.removeAttribute("aria-hidden");v.on();const d=s?r:a;__privateSet(this,$e,f(n,{fallbackFocus:d,escapeDeactivates:()=>{this.hide();return true}}));null==(i=__privateGet(this,$e))?void 0:i.activate();return new Promise((e=>{const t=d;const fn=i=>{t.removeEventListener("result",fn);const n=i.detail;this.hide();e("change"===n?{type:"change",feature:s}:{type:n})};t.addEventListener("result",fn)}))}))}tryShow(e,t){return __async(this,null,(function*(){if(!__privateGet(this,Re))return{type:"cancel"};const{accessToken:n,options:r={}}=t;const a=new s(__spreadValues({accessToken:n},r));const o=getAutofillSearchText(e);const l=yield a.validate(o,{sessionToken:je.autofillSessionToken});const h=l.features[0];if(h){const defaultValidation=e=>e.properties.match_code.confidence===i.exact;const{skipConfirmModal:e=defaultValidation}=t;if(e(h))return{type:"nochange"}}return yield this.show(e,t,h)}))}};Pe=new WeakMap;Re=new WeakMap;$e=new WeakMap;De=new WeakMap;window.MapboxAddressConfirmation=_e;window.customElements.get("mapbox-address-confirmation")||customElements.define("mapbox-address-confirmation",_e);var He=new _e;function confirmAddress(e){return __async(this,arguments,(function*(e,s={}){const{sections:i=[]}=s;He.parentNode||document.body.appendChild(He);let n={type:"nochange"};const r=findAddressInputs(e);const a=parseFormStructure(e);const o=Array.from(document.querySelectorAll("mapbox-search-listbox"));for(const l of r){if(i.length){const e=a.find((e=>e.input===l));if(!e)continue;if(!i.includes(e.section))continue}const r=getFormAutofillValues(e,l);const h=o.find((e=>e.input===l));const c=null==h?void 0:h.autofillHost;if(c){const e=c.retrieveFeature;if(e){const t=featureToAutofillValueMap(e);if(!checkAutofillValuesChanged(r,t))continue}}const d=s.accessToken||je.accessToken;const u=yield He.tryShow(r,__spreadProps(__spreadValues({},s),{accessToken:d}));if("change"===u.type)if(h)c.simulateRetrieve(u.feature);else{l.dataset.mapboxSuccess="true";const s=t(u.feature);setFormAutofillValues(e,l,s)}"change"===u.type&&"cancel"!==n.type&&(n=u);"cancel"===u.type&&(n=u)}return n}))}function createAddressElement(e,t){if(t){const s=createElementFromString("\n        <span>\n          <span></span>\n          <br />\n          <span></span>\n        </span>\n      ");const[i,n]=Array.from(s.querySelectorAll("span > span"));const r=t.split(",");i.textContent=r[0].trim();n.textContent=r.slice(1).join(",").trim();if(e["address-line2"]){const t=document.createElement("span");t.textContent=e["address-line2"];s.insertBefore(t,n);s.insertBefore(document.createElement("br"),n)}if(e["address-line3"]){const t=document.createElement("span");t.textContent=e["address-line3"];s.insertBefore(t,n);s.insertBefore(document.createElement("br"),n)}return s}{const t=e["street-address"]||e["address-line1"]||"";const s=e["address-line2"];const i=e["address-line3"];const n=[e["address-level4"]||"",e["address-level3"]||"",e["address-level2"]||"",`${e["address-level1"]||""} ${e["postal-code"]||""}`,e.country||e["country-name"]||""].filter(Boolean).join(", ");const r=[t,s,i,n].filter(Boolean);const a=r.map((e=>`<span>${e}</span>`)).join("<br />");const o=createElementFromString(`\n        <span>${a}</span>\n      `);return o}}function tryConfirmBrowserAutofill(e,t,s,i){return __async(this,null,(function*(){if(!s)return;const n=findParentForm(e);const r=Object.values(findAddressAutofillInputs(n,e));if(!t.detail.elements.some((e=>r.includes(e))))return;const a=parseFormStructure(n);const o=a.find((t=>t.input===e));const l=o.section;const h=Array.from(new Set(a.filter((e=>t.detail.elements.includes(e.input))).map((e=>e.section))));if(!h.includes(l))return;const c="object"===typeof s&&s.sections||[];if(c.length&&!c.some((e=>h.includes(e))))return;let d="object"===typeof s?s:{};d=__spreadProps(__spreadValues({},d),{accessToken:i,sections:[l]});yield confirmAddress(n,d)}))}var ze="https://contribute-api.mapbox.com/v1";var qe="https://contribute-api-staging.tilestream.net/v1";var Ve="edit-suggestion";function sendFeedback(e,t){if(!je.feedbackEnabled)return;const s=window.location.hostname;const i=isLocalServer(s)||isMapboxDomain(s)?qe:ze;const n=`${i}/${Ve}/address?access_token=${e}`;const{originalCoordinate:r,originalAddress:a,changes:o}=t;const l={action:"update",reason:"incorrect_address",location:{longitude:r[0],latitude:r[1]},userEmail:"no-reply-autofill@mapbox.com",changes:o,placeName:a};fetch(n,{method:"POST",headers:new Headers({"User-Agent":`mapbox-search-js.${X}.${navigator.userAgent}`,"Content-Type":"application/json"}),body:JSON.stringify(l)})}var Ne=createElementFromString('\n<template>\n  <div class="MapboxAddressConfirmationFeature">\n    <div class="Modal" aria-modal="true" role="dialog">\n      <div class="ModalHeader">\n        <svg viewBox="0 0 18 18" class="Icon IconQuestion"></svg>\n        <div class="ModalHeaderTitle">Did you mean?</div>\n        <svg\n          viewBox="0 0 18 18"\n          class="Icon IconClose"\n          tabindex="0"\n          role="button"\n          title="Close"\n          aria-label="Close"\n          aria-expanded="true"\n        ></svg>\n      </div>\n\n      <div class="ModalAddress ModalAddressApprove"></div>\n            \n      <div class="ModalMap">\n        <mapbox-address-minimap class="Minimap"></mapbox-address-minimap>\n      </div>\n\n      <div\n        class="Button ButtonPrimary ButtonApprove"\n        tabindex="0"\n        role="button"\n        aria-label="Yes"\n      >\n        Yes\n      </div>\n      \n      <div\n        class="Button ButtonSecondary ButtonReject"\n        tabindex="0"\n        role="button"\n        aria-label="No, use the address I provided"\n      >\n        No, use the address I provided\n      </div>\n\n      <div class="ModalFooter">\n          Your confirmation helps improve address data accuracy.\n      </div>\n    </div>\n  </div>\n</template>\n');var Ye,Xe,Ue,Ze,Qe,Je,Ke,Ge;var et=class extends H{constructor(){super(...arguments);__privateAdd(this,Ye,void 0);__privateAdd(this,Xe,{});this.minimap=false;__privateAdd(this,Ue,void 0);__privateAdd(this,Ze,void 0);this.update=(e,t)=>{__privateSet(this,Ue,e);__privateSet(this,Ze,t);const{ModalMap:s,Minimap:i,ModalAddressApprove:n}=__privateGet(this,Ye);if(this.minimap){s.removeAttribute("aria-hidden");i.accessToken=this.accessToken;if("object"===typeof this.minimap){const{defaultMapStyle:e,theme:t,mapStyleMode:s,satelliteToggle:n}=this.minimap;e&&(i.defaultMapStyle=this.minimap.defaultMapStyle);t&&(i.theme=this.minimap.theme);s&&(i.mapStyleMode=s);void 0!==n&&(i.satelliteToggle=n)}i.feature=e}else s.setAttribute("aria-hidden","true");const r=e.properties.place_name||e.properties.full_address||e.properties.address;n.innerHTML="";n.appendChild(createAddressElement(t,r))};__privateAdd(this,Qe,(()=>{this.dispatchEvent(new ie("result","cancel"))}));this.approve=()=>{this.dispatchEvent(new ie("result","change"))};this.reject=()=>{this.dispatchEvent(new ie("result","nochange"));sendFeedback(this.accessToken,{originalCoordinate:__privateGet(this,Ue).geometry.coordinates,originalAddress:__privateGet(this,Ue).properties.full_address,changes:{address:getAutofillSearchText(__privateGet(this,Ze))}})};__privateAdd(this,Je,randomValidID());__privateAdd(this,Ke,randomValidID());__privateAdd(this,Ge,randomValidID())}get template(){return Ne}get templateStyle(){return se}get templateUserStyle(){return getThemeCSS(".MapboxAddressConfirmationFeature",this.theme)}get theme(){return __privateGet(this,Xe)}set theme(e){__privateSet(this,Xe,e);if(!__privateGet(this,Ye)||!e)return;this.updateTemplateUserStyle(getThemeCSS(".MapboxAddressConfirmationFeature",e));const{IconQuestion:t,IconClose:s}=__privateGet(this,Ye);t.innerHTML=getIcon("question",e);s.innerHTML=getIcon("close",e)}set footer(e){if(void 0===e)return;const t=this.querySelector(".ModalFooter");if("string"===typeof e){t.textContent=e;t.removeAttribute("aria-hidden")}else e?t.removeAttribute("aria-hidden"):t.setAttribute("aria-hidden","true")}connectedCallback(){super.connectedCallback();__privateSet(this,Ye,bindElements(this,{MapboxAddressConfirmationFeature:".MapboxAddressConfirmationFeature",Modal:".Modal",ModalHeaderTitle:".ModalHeaderTitle",ModalMap:".ModalMap",Minimap:".Minimap",IconQuestion:".IconQuestion",IconClose:".IconClose",ButtonApprove:".ButtonApprove",ButtonReject:".ButtonReject",ModalAddressApprove:".ModalAddressApprove"}));const{Modal:e,ModalHeaderTitle:t,IconClose:s,ButtonApprove:i,ButtonReject:n,ModalAddressApprove:r}=__privateGet(this,Ye);e.setAttribute("aria-labelledby",__privateGet(this,Ke));e.setAttribute("aria-describedby",__privateGet(this,Ge));s.setAttribute("aria-controls",__privateGet(this,Je));e.id=__privateGet(this,Je);t.id=__privateGet(this,Ke);r.id=__privateGet(this,Ge);const a=Array.from(this.querySelectorAll('[role="button"]'));for(const e of a)e.addEventListener("keydown",ariaButtonKeyDown);s.addEventListener("click",__privateGet(this,Qe));i.addEventListener("click",this.approve);n.addEventListener("click",this.reject);const o=this.theme;if(o){const{IconQuestion:e,IconClose:t}=__privateGet(this,Ye);e.innerHTML=getIcon("question",o);t.innerHTML=getIcon("close",o)}}disconnectedCallback(){const{IconClose:e,ButtonApprove:t}=__privateGet(this,Ye);e.removeEventListener("click",__privateGet(this,Qe));t.removeEventListener("click",this.approve)}};Ye=new WeakMap;Xe=new WeakMap;Ue=new WeakMap;Ze=new WeakMap;Qe=new WeakMap;Je=new WeakMap;Ke=new WeakMap;Ge=new WeakMap;window.MapboxAddressConfirmationFeature=et;window.customElements.get("mapbox-address-confirmation-feature")||customElements.define("mapbox-address-confirmation-feature",et);var tt=createElementFromString('\n<template>\n  <div class="MapboxAddressConfirmationNoFeature">\n    <div class="Modal" aria-modal="true" role="dialog">\n      <div class="ModalHeader">\n        <svg viewBox="0 0 18 18" class="Icon IconQuestion"></svg>\n        <div class="ModalHeaderTitle">Confirm address</div>\n        <svg\n          viewBox="0 0 18 18"\n          class="Icon IconClose"\n          tabindex="0"\n          role="button"\n          title="Close"\n          aria-label="Close"\n          aria-expanded="true"\n        ></svg>\n      </div>\n      <div class="ModalDescription">\n        We couldn\'t verify this address. Please check that your information is correct before continuing.\n      </div>\n      <br />\n      <div class="ModalSubheader">\n        You entered\n      </div>\n      <div class="ModalAddress"></div>\n      <div\n        class="Button ButtonPrimary"\n        tabindex="0"\n        role="button"\n        aria-label="Use the address I provided"\n      >\n        Use the address I provided\n      </div>\n    </div>\n  </div>\n</template>\n');var st,it,nt,rt,at,ot;var lt=class extends H{constructor(){super(...arguments);__privateAdd(this,st,void 0);__privateAdd(this,it,{});this.update=e=>{const{ModalAddress:t}=__privateGet(this,st);t.innerHTML="";t.appendChild(createAddressElement(e))};__privateAdd(this,nt,(()=>{this.dispatchEvent(new ie("result","cancel"))}));this.reject=()=>{this.dispatchEvent(new ie("result","nochange"))};__privateAdd(this,rt,randomValidID());__privateAdd(this,at,randomValidID());__privateAdd(this,ot,randomValidID())}get template(){return tt}get templateStyle(){return se}get templateUserStyle(){return getThemeCSS(".MapboxAddressConfirmationNoFeature",this.theme)}get theme(){return __privateGet(this,it)}set theme(e){__privateSet(this,it,e);if(!__privateGet(this,st)||!e)return;this.updateTemplateUserStyle(getThemeCSS(".MapboxAddressConfirmationNoFeature",e));const{IconQuestion:t,IconClose:s}=__privateGet(this,st);t.innerHTML=getIcon("question",e);s.innerHTML=getIcon("close",e)}connectedCallback(){super.connectedCallback();__privateSet(this,st,bindElements(this,{Modal:".Modal",ModalHeaderTitle:".ModalHeaderTitle",IconQuestion:".IconQuestion",IconClose:".IconClose",ModalAddress:".ModalAddress",ButtonReject:".Button"}));const{Modal:e,ModalHeaderTitle:t,IconClose:s,ModalAddress:i,ButtonReject:n}=__privateGet(this,st);e.setAttribute("aria-labelledby",__privateGet(this,at));e.setAttribute("aria-describedby",__privateGet(this,ot));s.setAttribute("aria-controls",__privateGet(this,rt));e.id=__privateGet(this,rt);t.id=__privateGet(this,at);i.id=__privateGet(this,ot);const r=Array.from(this.querySelectorAll('[role="button"]'));for(const e of r)e.addEventListener("keydown",ariaButtonKeyDown);s.addEventListener("click",__privateGet(this,nt));n.addEventListener("click",this.reject);const a=this.theme;if(a){const{IconQuestion:e,IconClose:t}=__privateGet(this,st);e.innerHTML=getIcon("question",a);t.innerHTML=getIcon("close",a)}}disconnectedCallback(){const{IconClose:e,ButtonReject:t}=__privateGet(this,st);e.removeEventListener("click",__privateGet(this,nt));t.removeEventListener("click",this.reject)}};st=new WeakMap;it=new WeakMap;nt=new WeakMap;rt=new WeakMap;at=new WeakMap;ot=new WeakMap;window.MapboxAddressConfirmationNoFeature=lt;window.customElements.get("mapbox-address-confirmation-no-feature")||customElements.define("mapbox-address-confirmation-no-feature",lt);var ht='input:-webkit-autofill,select:-webkit-autofill,textarea:-webkit-autofill{animation-name:onbrowserautofillstart}input:not(:-webkit-autofill),select:not(:-webkit-autofill),textarea:not(:-webkit-autofill){animation-name:onbrowserautofillcancel}@keyframes onbrowserautofillstart{0%{animation-name:"onbrowserautofillstart"}to{animation-name:"onbrowserautofillstart"}}@keyframes onbrowserautofillcancel{0%{animation-name:"onbrowserautofillcancel"}to{animation-name:"onbrowserautofillcancel"}}';var ct="browser-autofilled";var dt=[];function dispatchBrowserAutofillEvent(){window.dispatchEvent(new window.CustomEvent("browserautofill",{bubbles:true,cancelable:true,detail:{elements:dt}}));dt=[]}var ut=n(dispatchBrowserAutofillEvent,5);function browserAutofill(e){if(!e.hasAttribute(ct)){e.setAttribute(ct,"");dt.push(e);ut()}}function cancelBrowserAutofill(e){e.hasAttribute(ct)&&e.removeAttribute(ct)}function onAnimationStart(e){"onbrowserautofillstart"===e.animationName?browserAutofill(e.target):cancelBrowserAutofill(e.target)}function onInput(e){const t=e.target;"select"===t.nodeName.toLowerCase()||e.simulated||e instanceof ie||"insertReplacementText"!==e.inputType&&"data"in e?cancelBrowserAutofill(t):browserAutofill(t)}function initDetectBrowserAutofill(){if(!je.detectBrowserAutofillEnabled){je.detectBrowserAutofillEnabled=true;addDocumentStyle(ht);document.addEventListener("animationstart",onAnimationStart,true);document.addEventListener("input",onInput,true)}}var pt,mt,vt,ft,gt,bt,wt,Mt,kt,yt,xt,St,At,Et,Ct,Tt;var Bt=class extends H{constructor(){super(...arguments);__privateAdd(this,pt,new r);__privateAdd(this,mt,new a(__privateGet(this,pt)));__privateAdd(this,vt,void 0);__privateAdd(this,ft,new Ee);__privateAdd(this,gt,void 0);this.options={};this.confirmOnBrowserAutofill=false;__privateAdd(this,bt,false);__privateAdd(this,wt,(e=>{const t=(null==e?void 0:e.suggestions)?distinctExactStreetResults(e.suggestions):null;__privateGet(this,ft).handleSuggest(t);this.dispatchEvent(new ie("suggest",e))}));__privateAdd(this,Mt,(e=>{__privateGet(this,ft).handleError();this.dispatchEvent(new ie("suggesterror",e))}));__privateAdd(this,kt,(e=>{var t;this.dispatchEvent(new ie("retrieve",e));this.retrieveFeature=null==(t=e.features)?void 0:t[0];if(!__privateGet(this,vt))return;const s=e;s&&s.features&&s.features.length&&fillFormWithFeature(s.features[0],__privateGet(this,vt))}));__privateAdd(this,yt,(()=>{var e;try{const t=null!=(e=this.querySelector("input"))?e:null;__privateSet(this,vt,t);__privateGet(this,ft).input=t}catch(e){__privateSet(this,vt,null);__privateGet(this,ft).input=null;console.error(e.message||e)}}));__privateAdd(this,xt,new MutationObserver(__privateGet(this,yt)));__privateAdd(this,St,(e=>{__privateGet(this,ft).blur();tryConfirmBrowserAutofill(__privateGet(this,vt),e,this.confirmOnBrowserAutofill,this.accessToken)}));this.retrieveFeature=null;this.interceptSearch=null;__privateAdd(this,At,(e=>{this.dispatchEvent(e.clone());const t=e.detail;const s=true===this.browserAutofillEnabled&&(null==t?void 0:t.length)<=2;toggleAutocompletion(__privateGet(this,vt),__privateGet(this,gt),s);const i=this.interceptSearch&&this.interceptSearch(t);const n=this.interceptSearch?i:t;this.interceptSearch&&!i||(null==n?void 0:n.length)<=2?__privateGet(this,ft).handleSuggest(null):__privateGet(this,mt).suggest(n,this.options)}));__privateAdd(this,Et,(e=>{const t=e.detail;if("street"!==e.detail.accuracy){toggleAutocompletion(__privateGet(this,vt),__privateGet(this,gt),true);__privateGet(this,mt).retrieve(t,this.options)}else handleStreetSelection(__privateGet(this,vt),__privateGet(this,gt),t)}));__privateAdd(this,Ct,(()=>{toggleAutocompletion(__privateGet(this,vt),__privateGet(this,gt),true);__privateGet(this,mt).abort()}));__privateAdd(this,Tt,(()=>{var e;const t=true===this.browserAutofillEnabled&&(null==(e=__privateGet(this,vt).value)?void 0:e.length)<=2;toggleAutocompletion(__privateGet(this,vt),__privateGet(this,gt),t)}))}get accessToken(){return __privateGet(this,pt).accessToken}set accessToken(e){__privateGet(this,pt).accessToken=e}get input(){return __privateGet(this,vt)}get theme(){return __privateGet(this,ft).theme}set theme(e){__privateGet(this,ft).theme=e}get popoverOptions(){return __privateGet(this,ft).popoverOptions}set popoverOptions(e){__privateGet(this,ft).popoverOptions=e}get browserAutofillEnabled(){return __privateGet(this,bt)}set browserAutofillEnabled(e){__privateSet(this,bt,e)}connectedCallback(){var e;super.connectedCallback();je.autofillSessionEnabled=true;__privateGet(this,mt).sessionToken=je.autofillSessionToken;__privateGet(this,ft).autofillHost=this;__privateGet(this,ft).searchService=0;const t=null!=(e=this.querySelector("input"))?e:null;__privateGet(this,xt).observe(this,{subtree:true,childList:true});__privateGet(this,yt).call(this);__privateGet(this,ft).addEventListener("input",__privateGet(this,At));__privateGet(this,ft).addEventListener("select",__privateGet(this,Et));__privateGet(this,ft).addEventListener("blur",__privateGet(this,Ct));__privateGet(this,ft).addEventListener("focus",__privateGet(this,Tt));__privateGet(this,mt).addEventListener("suggest",__privateGet(this,wt));__privateGet(this,mt).addEventListener("suggesterror",__privateGet(this,Mt));__privateGet(this,mt).addEventListener("retrieve",__privateGet(this,kt));document.body.appendChild(__privateGet(this,ft));if(t){t.insertAdjacentElement("beforebegin",createAriaLiveElement(__privateGet(this,ft).dataSeed));suppressExtensionsAutocomplete(t);__privateSet(this,gt,t.autocomplete)}initDetectBrowserAutofill();window.addEventListener("browserautofill",__privateGet(this,St))}disconnectedCallback(){__privateGet(this,ft).remove();__privateGet(this,ft).removeEventListener("input",__privateGet(this,At));__privateGet(this,ft).removeEventListener("select",__privateGet(this,Et));__privateGet(this,ft).removeEventListener("blur",__privateGet(this,Ct));__privateGet(this,ft).removeEventListener("focus",__privateGet(this,Tt));__privateGet(this,mt).removeEventListener("suggest",__privateGet(this,wt));__privateGet(this,mt).removeEventListener("suggesterror",__privateGet(this,Mt));__privateGet(this,mt).removeEventListener("retrieve",__privateGet(this,kt));__privateGet(this,xt).disconnect();window.removeEventListener("browserautofill",__privateGet(this,St))}attributeChangedCallback(e,t,s){if("access-token"===e){__privateGet(this,pt).accessToken=s;return}if("browser-autofill-enabled"===e){__privateSet(this,bt,Boolean(s));return}if("theme"===e){this.theme=tryParseJSON(s);return}if("popover-options"===e){this.popoverOptions=tryParseJSON(s);return}const i=e.split("-").join("_");s||delete this.options[i];this.options[i]=s}focus(){__privateGet(this,ft).focus()}simulateRetrieve(e){const t=this.input;t&&(t.dataset.mapboxSuccess="true");__privateGet(this,ft).hideResults();const s={type:"FeatureCollection",features:[e],url:""};__privateGet(this,kt).call(this,s)}};pt=new WeakMap;mt=new WeakMap;vt=new WeakMap;ft=new WeakMap;gt=new WeakMap;bt=new WeakMap;wt=new WeakMap;Mt=new WeakMap;kt=new WeakMap;yt=new WeakMap;xt=new WeakMap;St=new WeakMap;At=new WeakMap;Et=new WeakMap;Ct=new WeakMap;Tt=new WeakMap;Bt.observedAttributes=["access-token","browser-autofill-enabled","theme","popover-options","css-text","language","country","bbox","limit","proximity","streets"];window.MapboxAddressAutofill=Bt;window.customElements.get("mapbox-address-autofill")||customElements.define("mapbox-address-autofill",Bt);var Wt={de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"לחפש",ja:"サーチ",lv:"Meklēt",pt:"Procurar",sr:"Претрага",zh:"搜索",cs:"Vyhledávání",hu:"Keresés",ka:"ძიება",nb:"Søke",sk:"Vyhľadávanie",th:"ค้นหา",fi:"Hae",is:"Leita",ko:"수색",pl:"Szukaj",sl:"Iskanje",fa:"جستجو",ru:"Поиск"};var Lt={placeholder:Wt};var It=9;var Ft,jt,Ot,Pt,Rt,$t,Dt,_t,Ht,zt,qt,Vt,Nt,Yt,Xt,Ut,Zt,Qt,Jt,Kt,Gt;var es=class extends H{constructor(){super(...arguments);__privateAdd(this,Dt);__privateAdd(this,Ft,void 0);__privateAdd(this,jt,new o({}));__privateAdd(this,Ot,new a(__privateGet(this,jt)));__privateAdd(this,Pt,null);__privateAdd(this,Rt,void 0);__privateAdd(this,$t,new Ee);this.options={};__privateAdd(this,Ht,void 0);__privateAdd(this,zt,(e=>{__privateGet(this,Jt).call(this);__privateGet(this,$t).handleSuggest((null==e?void 0:e.suggestions)||null);this.dispatchEvent(new ie("suggest",e))}));__privateAdd(this,qt,(e=>{__privateGet(this,Jt).call(this);__privateGet(this,$t).handleError();this.dispatchEvent(new ie("suggesterror",e))}));__privateAdd(this,Vt,(e=>{__privateGet(this,Jt).call(this);this.dispatchEvent(new ie("retrieve",e));const s=e;if(!s||!s.features.length)return;const i=t(s.features[0]);__privateGet(this,Rt).value=i.name;const n=__privateGet(this,Pt);if(!n)return;const r=s.features[0];if(!r)return;const a=r.properties.feature_type;const o=r.properties.bbox;if(o)n.flyTo(bboxViewport(n,l.convert(o).toFlatArray()));else{const e=r.geometry.coordinates;const t=getMaxZoom(a);n.flyTo({center:e,zoom:t,speed:B})}this.marker&&this.mapboxgl&&__privateGet(this,Xt).call(this,r)}));__privateAdd(this,Nt,void 0);__privateAdd(this,Yt,(()=>{if(__privateGet(this,Nt)){__privateGet(this,Nt).remove();__privateSet(this,Nt,null)}}));__privateAdd(this,Xt,(e=>{if(!__privateGet(this,Pt))return;__privateGet(this,Yt).call(this);if(!e)return;const t={color:"#4668F2"};const s=__spreadValues(__spreadValues({},t),"object"===typeof this.marker&&this.marker);__privateSet(this,Nt,new this.mapboxgl.Marker(s));e.geometry&&e.geometry.type&&"Point"===e.geometry.type&&e.geometry.coordinates&&__privateGet(this,Nt).setLngLat(e.geometry.coordinates).addTo(__privateGet(this,Pt))}));this.interceptSearch=null;__privateAdd(this,Ut,(e=>{this.dispatchEvent(e.clone());const t=e.detail;if(!t){__privateGet(this,Kt).call(this);return}const s=this.interceptSearch&&this.interceptSearch(t);const i=this.interceptSearch?s:t;if(!this.interceptSearch||s){__privateGet(this,Ot).suggest(i,this.options);__privateGet(this,Jt).call(this,true)}else __privateGet(this,$t).hideResults()}));__privateAdd(this,Zt,(e=>{const t=e.detail;__privateGet(this,Ot).retrieve(t,this.options);__privateGet(this,Jt).call(this,true)}));__privateAdd(this,Qt,(()=>{__privateGet(this,Ot).abort()}));__privateAdd(this,Jt,((e=false)=>{if(e){__privateGet(this,Ft).ClearBtn.style.display="none";__privateGet(this,Ft).LoadingIcon.style.display="block"}else{__privateGet(this,Ft).LoadingIcon.style.display="none";__privateGet(this,Ft).ClearBtn.style.display=this.value?"block":"none"}}));__privateAdd(this,Kt,(()=>{this.value="";__privateGet(this,Jt).call(this);__privateGet(this,Xt).call(this,null);__privateGet(this,$t).handleSuggest(null)}));this.marker=true;__privateAdd(this,Gt,(()=>{const e=__privateGet(this,Pt);const t=__spreadValues({},this.options);if(e.getZoom()<=It){delete t.proximity;this.options=t;return}const s=e.getCenter();this.options=__spreadProps(__spreadValues({},t),{proximity:s})}))}get accessToken(){return __privateGet(this,jt).accessToken}set accessToken(e){__privateGet(this,jt).accessToken=e}get value(){return __privateGet(this,Rt).value}set value(e){__privateGet(this,Rt).value=e}get input(){return __privateGet(this,Rt)}get template(){return R}get templateStyle(){return se}get templateUserStyle(){return getThemeCSS(".SearchBox",__privateGet(this,$t).theme)}get theme(){return __privateGet(this,$t).theme}set theme(e){__privateGet(this,$t).theme=e;if(!__privateGet(this,Ft)||!e)return;this.updateTemplateUserStyle(getThemeCSS(".SearchBox",e));__privateGet(this,$t).updatePopover();const{SearchIcon:t}=__privateGet(this,Ft);t.innerHTML=getIcon("search",e)}get popoverOptions(){return __privateGet(this,$t).popoverOptions}set popoverOptions(e){__privateGet(this,$t).popoverOptions=e}get placeholder(){return __privateGet(this,Ht)||__privateMethod(this,Dt,_t).call(this)}set placeholder(e){__privateSet(this,Ht,e);if(__privateGet(this,Rt)){__privateGet(this,Rt).placeholder=this.placeholder;__privateGet(this,Rt).setAttribute("aria-label",this.placeholder)}}connectedCallback(){super.connectedCallback();__privateSet(this,Ft,bindElements(this,{SearchBox:".SearchBox",SearchIcon:".SearchIcon",Input:".Input",ClearBtn:".ClearBtn",LoadingIcon:".LoadingIcon"}));this.theme=__spreadValues({},this.theme);const{Input:e,ClearBtn:t}=__privateGet(this,Ft);__privateSet(this,Rt,e);__privateGet(this,$t).input=e;__privateGet(this,$t).searchService=3;__privateGet(this,$t).addEventListener("input",__privateGet(this,Ut));__privateGet(this,$t).addEventListener("select",__privateGet(this,Zt));__privateGet(this,$t).addEventListener("blur",__privateGet(this,Qt));__privateGet(this,Ot).addEventListener("suggest",__privateGet(this,zt));__privateGet(this,Ot).addEventListener("suggesterror",__privateGet(this,qt));__privateGet(this,Ot).addEventListener("retrieve",__privateGet(this,Vt));t.addEventListener("click",__privateGet(this,Kt));this.placeholder=__privateGet(this,Ht);document.body.appendChild(__privateGet(this,$t));if(e){e.previousElementSibling.hasAttribute("aria-live")&&e.previousElementSibling.remove();e.insertAdjacentElement("beforebegin",createAriaLiveElement(__privateGet(this,$t).dataSeed))}}disconnectedCallback(){__privateGet(this,$t).remove();__privateGet(this,$t).input=null;__privateGet(this,$t).removeEventListener("input",__privateGet(this,Ut));__privateGet(this,$t).removeEventListener("select",__privateGet(this,Zt));__privateGet(this,$t).removeEventListener("blur",__privateGet(this,Qt));__privateGet(this,Ot).removeEventListener("suggest",__privateGet(this,zt));__privateGet(this,Ot).removeEventListener("suggesterror",__privateGet(this,qt));__privateGet(this,Ot).removeEventListener("retrieve",__privateGet(this,Vt))}attributeChangedCallback(e,t,s){if("access-token"===e){__privateGet(this,jt).accessToken=s;return}if("theme"===e){this.theme=tryParseJSON(s);return}if("popover-options"===e){this.popoverOptions=tryParseJSON(s);return}if("placeholder"===e){this.placeholder=s;return}const i=e.split("-").join("_");s||delete this.options[i];this.options[i]=s;"language"===i&&(this.placeholder=__privateGet(this,Ht))}focus(){__privateGet(this,$t).focus()}search(e){this.value=e;__privateGet(this,Ut).call(this,new ie("input",e))}bindMap(e){__privateGet(this,Pt)&&__privateGet(this,Pt).off("moveend",__privateGet(this,Gt));e&&e.on("moveend",__privateGet(this,Gt));__privateSet(this,Pt,e)}unbindMap(){this.bindMap(null)}onAdd(e){this.bindMap(e);this.remove();const t=document.createElement("div");t.className="mapboxgl-ctrl";t.style.width="300px";t.appendChild(this);return t}onRemove(){this.remove();this.unbindMap();__privateGet(this,Yt).call(this)}getDefaultPosition(){return"top-right"}};Ft=new WeakMap;jt=new WeakMap;Ot=new WeakMap;Pt=new WeakMap;Rt=new WeakMap;$t=new WeakMap;Dt=new WeakSet;_t=function(){if(this.options.language){const e=this.options.language.split(",")[0];const t=g.language(e);const s=Lt.placeholder[t];if(s)return s}return"Search"};Ht=new WeakMap;zt=new WeakMap;qt=new WeakMap;Vt=new WeakMap;Nt=new WeakMap;Yt=new WeakMap;Xt=new WeakMap;Ut=new WeakMap;Zt=new WeakMap;Qt=new WeakMap;Jt=new WeakMap;Kt=new WeakMap;Gt=new WeakMap;es.observedAttributes=["access-token","theme","popover-options","placeholder","language","country","bbox","limit","navigation-profile","origin","proximity","eta-type","types"];window.MapboxSearchBox=es;window.customElements.get("mapbox-search-box")||customElements.define("mapbox-search-box",es);var ts=new b({size:512,antimeridian:true});var ss=1280;function getAnchorOffset(e,t){const{width:s,height:i}=getElementSize(e,true);switch(t){case"center":return[0,0];case"top":return[0,i/2];case"bottom":return[0,-1*i/2];case"left":return[s/2,0];case"right":return[-1*s/2,0];case"top-left":return[s/2,i/2];case"top-right":return[-1*s/2,i/2];case"bottom-left":return[s/2,-1*i/2];case"bottom-right":return[-1*s/2,-1*i/2]}}var is,ns,rs,as,os,ls,hs,cs,ds,us,ps,ms,vs,fs;var gs=class{constructor(e,t,s,i,n,r){__privateAdd(this,is,void 0);__privateAdd(this,ns,(()=>{[this.anchorOffsetX,this.anchorOffsetY]=getAnchorOffset(this.markerElement,this.anchor);this.markerTransform={anchorX:this.anchorOffsetX,anchorY:this.anchorOffsetY}}));__privateAdd(this,rs,{anchorX:0,anchorY:0,globalX:0,globalY:0,correctionX:0,correctionY:0});__privateAdd(this,as,false);__privateAdd(this,os,void 0);__privateAdd(this,ls,(e=>{if(this.isActive){e.preventDefault();e.stopPropagation();__privateGet(this,ms).call(this,e);window.addEventListener("pointermove",__privateGet(this,cs));window.addEventListener("pointerup",__privateGet(this,hs))}}));__privateAdd(this,hs,(()=>{window.removeEventListener("pointermove",__privateGet(this,cs));window.removeEventListener("pointerup",__privateGet(this,hs))}));__privateAdd(this,cs,(e=>{e.preventDefault();e.stopPropagation();const t=this.curPointerXPos-e.pageX;const s=this.curPointerYPos-e.pageY;this.markerDeltaX+=t;this.markerDeltaY-=s;this.markerDeltaX=Math.max(Math.min(this.imgElement.width/2,this.markerDeltaX),this.imgElement.width/2*-1);this.markerDeltaY=Math.max(Math.min(this.imgElement.height/2,this.markerDeltaY),this.imgElement.height/2*-1);const i=this.imgCenterPx[0]-this.imgCenterAdjustedPx[0];const n=this.imgCenterPx[1]-this.imgCenterAdjustedPx[1];const r=this.markerDeltaX-i;const a=this.markerDeltaY+n;this.markerTransform={globalX:r,globalY:a};__privateGet(this,ms).call(this,e)}));__privateAdd(this,ds,(e=>{if(this.isActive){e.preventDefault();e.stopPropagation();__privateGet(this,ms).call(this,e);window.addEventListener("pointermove",__privateGet(this,ps));window.addEventListener("pointerup",__privateGet(this,us))}}));__privateAdd(this,us,(()=>{window.removeEventListener("pointermove",__privateGet(this,ps));window.removeEventListener("pointerup",__privateGet(this,us))}));__privateAdd(this,ps,(e=>{e.preventDefault();let t=Math.round(this.imgContainerElement.scrollTop+(this.curPointerYPos-e.pageY));t=Math.max(Math.min(this.imgElement.height-this.imgContainerElement.clientHeight,t),0);let s=Math.round(this.imgContainerElement.scrollLeft+(this.curPointerXPos-e.pageX));s=Math.max(Math.min(this.imgElement.width-this.imgContainerElement.clientWidth,s),0);this.imgContainerElement.scrollTop=t;this.imgContainerElement.scrollLeft=s;const i=Math.round(s-(this.imgElement.width-this.imgContainerElement.clientWidth)/2);const n=Math.round((this.imgElement.height-this.imgContainerElement.clientHeight)/2-t);this.imgCenterAdjustedPx=[this.imgCenterPx[0]+i,this.imgCenterPx[1]-n];if(!this.keepMarkerCentered){const e=this.markerDeltaX+i;const t=this.markerDeltaY+n;this.markerTransform={globalX:e,globalY:t}}__privateGet(this,fs).call(this,s,t);__privateGet(this,ms).call(this,e)}));__privateAdd(this,ms,(e=>{this.curPointerXPos=e.pageX;this.curPointerYPos=e.pageY}));__privateAdd(this,vs,(()=>{const{anchorX:e,anchorY:t,globalX:s,globalY:i,correctionX:n,correctionY:r}=__privateGet(this,rs);const a=e-s+n;const o=t+i+r;this.markerElement.style.transform=`translate(calc(-50% + ${a}px), calc(-50% + ${o}px))`}));this.reCenter=()=>{const e=(this.imgElement.height-this.imgContainerElement.clientHeight)/2;const t=(this.imgElement.width-this.imgContainerElement.clientWidth)/2;this.imgContainerElement.scrollTop=e;this.imgContainerElement.scrollLeft=t;this.imgCenterAdjustedPx=this.imgCenterPx;this.markerDeltaX=this.markerDeltaY=0;this.markerTransform={globalX:0,globalY:0,correctionX:0,correctionY:0}};this.handleMinimapResize=()=>{if(!this.imgElement.height||!this.imgElement.width)return;const e=this.imgCenterOffset.x;const t=this.imgCenterOffset.y;const s=this.imgElement.width/2-e-this.imgContainerElement.clientWidth/2;const i=this.imgElement.height/2-t-this.imgContainerElement.clientHeight/2;this.imgContainerElement.scrollLeft=s;this.imgContainerElement.scrollTop=i;__privateGet(this,fs).call(this,s,i)};__privateAdd(this,fs,((e,t)=>{const s=this.imgCenterOffset.x;const i=this.imgCenterOffset.y;const{correctionX:n,correctionY:r}=this.markerTransform;const a={};if(e/2<-1*s){const t=-1*s-e/2;a.correctionX=2*t}else e<0?a.correctionX=e:0!==n&&(a.correctionX=0);if(t/2<-1*i){const e=-1*i-t/2;a.correctionY=2*e}else t<0?a.correctionY=t:0!==r&&(a.correctionY=0);this.markerTransform=a}));this.markerElement=s;this.imgContainerElement=e;this.imgElement=t;this.keepMarkerCentered=i;this.zoom=n;this.anchor=r;this.curPointerXPos=0;this.curPointerYPos=0;this.markerDeltaX=0;this.markerDeltaY=0;this.imgContainerElement.addEventListener("pointerdown",__privateGet(this,ds));this.keepMarkerCentered||this.markerElement.addEventListener("pointerdown",__privateGet(this,ls));const a=new ResizeObserver(__privateGet(this,ns));a.observe(this.markerElement)}get anchor(){return __privateGet(this,is)}set anchor(e){__privateSet(this,is,e);[this.anchorOffsetX,this.anchorOffsetY]=getAnchorOffset(this.markerElement,e);this.markerTransform={anchorX:this.anchorOffsetX,anchorY:this.anchorOffsetY}}get markerTransform(){return __privateGet(this,rs)}set markerTransform(e){__privateSet(this,rs,__spreadValues(__spreadValues({},__privateGet(this,rs)),e));__privateGet(this,vs).call(this)}get isActive(){return __privateGet(this,as)}set isActive(e){this.imgContainerElement.style.touchAction=e?"none":"";__privateSet(this,as,e)}get coordinate(){const e=this.keepMarkerCentered?this.imgCenterAdjustedPx:[this.imgCenterPx[0]-this.markerDeltaX,this.imgCenterPx[1]+this.markerDeltaY];if(deepEquals(e,this.imgCenterPx))return __privateGet(this,os);{const t=ts.ll(e,this.zoom);return[round(t[0],6),round(t[1],6)]}}set coordinate(e){__privateSet(this,os,e);this.imgCenterPx=this.imgCenterAdjustedPx=ts.px(e,this.zoom)}get imgCenterOffset(){return{x:this.imgCenterPx[0]-this.imgCenterAdjustedPx[0],y:this.imgCenterPx[1]-this.imgCenterAdjustedPx[1]}}};is=new WeakMap;ns=new WeakMap;rs=new WeakMap;as=new WeakMap;os=new WeakMap;ls=new WeakMap;hs=new WeakMap;cs=new WeakMap;ds=new WeakMap;us=new WeakMap;ps=new WeakMap;ms=new WeakMap;vs=new WeakMap;fs=new WeakMap;var bs='<svg width="88" height="23" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill-rule="evenodd"><defs><path id="g" d="M11.5 2.25a9.25 9.25 0 1 1 0 18.5 9.25 9.25 0 0 1 0-18.5zM7 15.98c-.05-.33-.83-5.8 2.23-8.87a4.4 4.4 0 0 1 3.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39a4.4 4.4 0 0 1-1.28 3.13C12.72 16.93 7 16 7 16v-.02zm8.3-5.48-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z"/><path id="b" d="M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19A3.77 3.77 0 0 1 50.86 15v3.77c0 .13-.1.23-.23.23h-1.4a.23.23 0 0 1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01.01-.01c.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4a.23.23 0 0 1-.23-.23V15a3.7 3.7 0 0 1-2.73 1.19c-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.38-.19a4.24 4.24 0 0 0-4.16 3.29 4.07 4.07 0 0 0 0 1.77 4.23 4.23 0 0 0 4.17 3.3 4.22 4.22 0 0 0 4.26-4.19 4.2 4.2 0 0 0-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18a4 4 0 0 1 3.84 3.28c.13.59.13 1.2 0 1.8a4 4 0 0 1-3.84 3.29A3.77 3.77 0 0 1 60.86 15v.77c0 .12-.1.23-.23.23h-1.4a.23.23 0 0 1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4a.23.23 0 0 1-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55a2.73 2.73 0 0 1 2.44-1.56c1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41a.23.23 0 0 1-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41a.23.23 0 0 1-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.62 0h-1.61a.27.27 0 0 1-.12-.03c-.1-.06-.13-.19-.06-.28l2.43-3.71-2.4-3.65a.21.21 0 0 1-.02-.12.2.2 0 0 1 .2-.21h1.61c.13 0 .24.06.3.17L82 10.54l1.4-2.37a.34.34 0 0 1 .3-.17h1.6l.12.03c.1.06.13.19.06.28l-2.37 3.65 2.43 3.7.01.13a.2.2 0 0 1-.2.21h-1.61a.33.33 0 0 1-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 0 1-.3.17zm-7.12-1.49A2.47 2.47 0 0 1 70.7 12a2.47 2.47 0 0 1 2.42-2.52 2.47 2.47 0 0 1 2.42 2.51 2.48 2.48 0 0 1-2.42 2.52zm-19.87 0a2.48 2.48 0 0 1-2.42-2.48v-.07a2.47 2.47 0 0 1 2.4-2.49 2.47 2.47 0 0 1 2.41 2.51 2.47 2.47 0 0 1-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51a2.47 2.47 0 0 1 2.4-2.52 2.46 2.46 0 0 1 2.41 2.48l.02.08zm18.12 2.47a2.47 2.47 0 0 1-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51a2.47 2.47 0 0 1-2.42 2.51z"/></defs><mask id="c"><rect width="100%" height="100%" fill="#fff"/><use xlink:href="#g"/><use xlink:href="#b"/></mask><g opacity=".3" stroke="#000" stroke-width="3"><circle mask="url(#c)" cx="11.5" cy="11.5" r="9.25"/><use xlink:href="#b" mask="url(#c)"/></g><g opacity=".9" fill="#fff"><use xlink:href="#g"/><use xlink:href="#b"/></g></svg>';var ws=16;var Ms=createElementFromString(`\n<template>\n  <div class="MapboxAddressMinimap" aria-hidden="true">\n    <div class="MinimapImageContainer">\n      <img class="MinimapImage" draggable="false"></img>\n      <div class="MinimapInnerFrame">\n        <div class="MinimapMarker"></div>\n        <div class="MinimapAttribution">\n          <div class="MinimapAttributionLogo">\n            <a target="_blank" rel="noopener nofollow" href="https://www.mapbox.com/" aria-label="Mapbox logo">\n              ${bs}\n            </a>\n          </div>\n          <div class="MinimapAttributionText">\n            <a target="_blank" href='https://www.mapbox.com/about/maps/'>© Mapbox</a><a target="_blank" href='http://www.openstreetmap.org/copyright'>© OpenStreetMap</a>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n`);var ks=createElementFromString('\n<template>\n  <button type="button" class="MinimapStyleToggle"></button>\n</template>\n');var ys=createElementFromString('\n<template>\n  <div class="MinimapFooter">Adjust the marker on the map if it doesn\'t precisely match your location. This helps improve address data quality.</div>\n</template>\n');var xs="Adjust pin";var Ss="Save";var As="Cancel";var Es=createElementFromString(`\n<template>\n  <div class="MinimapEditButtons">\n    <div class="Button ButtonPrimary MinimapButtonAdjust">${xs}</div>\n    <div class="Button ButtonPrimary MinimapButtonSave" aria-hidden="true">${Ss}</div>\n    <div class="Button MinimapButtonCancel" aria-hidden="true">${As}</div>\n  </div>\n</template>\n`);var Cs,Ts,Bs,Ws,Ls,Is,Fs,js,Os,Ps,Rs,$s,Ds,_s,Hs,zs,qs,Vs,Ns,Ys,Xs,Us,Zs,Qs,Js,Ks,Gs,ei,ti,si,ii,ni,ri,ai;var oi=class extends H{constructor(){super(...arguments);__privateAdd(this,Cs,false);this.keepMarkerCentered=false;this.markerAnchor="bottom";__privateAdd(this,Ts,false);__privateAdd(this,Bs,false);__privateAdd(this,Ws,void 0);__privateAdd(this,Ls,"");__privateAdd(this,Is,void 0);__privateAdd(this,Fs,void 0);__privateAdd(this,js,void 0);__privateAdd(this,Os,void 0);__privateAdd(this,Ps,void 0);__privateAdd(this,Rs,{});__privateAdd(this,$s,false);__privateAdd(this,Ds,"default");__privateAdd(this,_s,void 0);__privateAdd(this,Hs,void 0);__privateAdd(this,zs,void 0);__privateAdd(this,qs,["mapbox","streets-v11"]);__privateAdd(this,Vs,void 0);__privateAdd(this,Ns,void 0);__privateAdd(this,Ys,(()=>{const{ImageContainer:e,ButtonAdjust:t,ButtonSave:s,ButtonCancel:i}=__privateGet(this,js);if(__privateGet(this,Ts)){e.classList.add(`${this.dataset.seed}--draggable`);__privateGet(this,Os).isActive=true;t.setAttribute("aria-hidden","true");s.removeAttribute("aria-hidden");i.removeAttribute("aria-hidden")}else{e.classList.remove(`${this.dataset.seed}--draggable`);__privateGet(this,Os).isActive=false;t.removeAttribute("aria-hidden");s.setAttribute("aria-hidden","true");i.setAttribute("aria-hidden","true")}}));__privateAdd(this,Xs,(()=>{__privateSet(this,Ts,true);__privateGet(this,Ys).call(this)}));__privateAdd(this,Us,(()=>{if(this.feature.properties.full_address&&!deepEquals(this.feature.geometry.coordinates,__privateGet(this,Os).coordinate)){const[e,t]=__privateGet(this,Os).coordinate;sendFeedback(this.accessToken,{originalCoordinate:this.feature.geometry.coordinates,originalAddress:this.feature.properties.full_address,changes:{location:{longitude:e,latitude:t}}})}this.onSaveMarkerLocation&&this.onSaveMarkerLocation(__privateGet(this,Os).coordinate);__privateSet(this,Ts,false);__privateGet(this,Ys).call(this)}));__privateAdd(this,Zs,(()=>{__privateGet(this,Os).reCenter();__privateSet(this,Ts,false);__privateGet(this,Ys).call(this)}));__privateAdd(this,Qs,(()=>{this.mapStyleMode="default"===this.mapStyleMode?"satellite":"default"}));__privateAdd(this,Js,(()=>{__privateGet(this,Bs)||__privateGet(this,Os).reCenter();__privateSet(this,Bs,true);__privateGet(this,Os)&&__privateGet(this,Os).handleMinimapResize()}));__privateAdd(this,Ks,(()=>{__privateSet(this,Bs,false)}));__privateAdd(this,Gs,(e=>{if(0===__privateGet(this,Is)||0===__privateGet(this,Fs))return"";const[t,s]=this.defaultMapStyle;const i=getStaticBaseUrl(t,s);const n="default"===this.mapStyleMode?i:I;const r=F+je.autofillSessionToken.toString();let a=n+h.convert(e).toArray().join(",")+","+ws+",0/"+Math.min(2*__privateGet(this,Is),ss)+"x"+Math.min(2*__privateGet(this,Fs),ss)+"?access_token="+this.accessToken+"&attribution=false&logo=false";je.autofillSessionEnabled&&(a+=`&sku=${r}`);return a}));__privateAdd(this,ei,(()=>{if(__privateGet(this,Ws)){const e=__privateGet(this,Ws).geometry.coordinates;__privateSet(this,Ls,__privateGet(this,Gs).call(this,e));const{Image:t}=__privateGet(this,js);t.src=__privateGet(this,Ls)}}));__privateAdd(this,ti,(e=>`url("${getImage("default"===e?"styleToggleDefault":"styleToggleSatellite",this.theme)}")`));__privateAdd(this,si,(()=>{const{MapboxAddressMinimap:e,ImageContainer:t,Image:s}=__privateGet(this,js);const{width:i,height:n}=getElementSize(this.container);const[r,a]=[__privateGet(this,Is),__privateGet(this,Fs)];__privateSet(this,Is,Math.min(i,ss));__privateSet(this,Fs,Math.min(n,ss));e.style.setProperty("width",`${__privateGet(this,Is)}px`);e.style.setProperty("height",`${__privateGet(this,Fs)}px`);t.style.setProperty("height",`${__privateGet(this,Fs)}px`);t.style.setProperty("width",`${__privateGet(this,Is)}px`);const[o,l]=[s.width,s.height];__privateGet(this,Is)>r&&__privateGet(this,Is)>o/2&&o<ss||__privateGet(this,Fs)>a&&__privateGet(this,Fs)>l/2&&l<ss?__privateGet(this,ei).call(this):__privateGet(this,Os)&&__privateGet(this,Os).handleMinimapResize()}));__privateAdd(this,ii,(()=>{const e=this.querySelector(".MinimapFooter");if(e)return;const t=this.prepareTemplate(ys);const s=this.querySelector(".MapboxAddressMinimap");if(!s)return;s.appendChild(t);const i=this.querySelector(".MinimapEditButtons");if(i)return;const n=this.prepareTemplate(Es);const r=this.querySelector(".MinimapInnerFrame");r.appendChild(n);__privateSet(this,js,__spreadProps(__spreadValues({},__privateGet(this,js)),{EditButtons:this.querySelector(".MinimapEditButtons"),ButtonAdjust:this.querySelector(".MinimapButtonAdjust"),ButtonSave:this.querySelector(".MinimapButtonSave"),ButtonCancel:this.querySelector(".MinimapButtonCancel")}));const{ButtonAdjust:a,ButtonSave:o,ButtonCancel:l}=__privateGet(this,js);a.addEventListener("click",__privateGet(this,Xs));o.addEventListener("click",__privateGet(this,Us));l.addEventListener("click",__privateGet(this,Zs))}));__privateAdd(this,ni,(()=>{if(!__privateGet(this,js))return;const{EditButtons:e,ButtonAdjust:t,ButtonSave:s,ButtonCancel:i}=__privateGet(this,js);const n=this.querySelector(".MinimapFooter");null==n?void 0:n.remove();null==e?void 0:e.remove();if(t){t.remove();t.removeEventListener("click",__privateGet(this,Xs))}if(s){s.remove();s.removeEventListener("click",__privateGet(this,Us))}if(i){i.remove();i.removeEventListener("click",__privateGet(this,Zs))}delete __privateGet(this,js).EditButtons;delete __privateGet(this,js).ButtonAdjust;delete __privateGet(this,js).ButtonSave;delete __privateGet(this,js).ButtonCancel}));__privateAdd(this,ri,(()=>{const e=this.querySelector(".MinimapStyleToggle");if(e)return;const t=this.prepareTemplate(ks);const s=this.querySelector(".MinimapInnerFrame");if(s){s.appendChild(t);__privateGet(this,js).MapStyleToggle=t;t.addEventListener("click",__privateGet(this,Qs));t.style.backgroundImage=__privateGet(this,ti).call(this,"default"===this.mapStyleMode?"satellite":"default");t.setAttribute("title","Switch to "+("default"===this.mapStyleMode?"Satellite":"Default"))}}));__privateAdd(this,ai,(()=>{if(!__privateGet(this,js))return;const{MapStyleToggle:e}=__privateGet(this,js);if(e){e.remove();e.removeEventListener("click",__privateGet(this,Qs));delete __privateGet(this,js).MapStyleToggle}}))}get canAdjustMarker(){return __privateGet(this,Cs)}set canAdjustMarker(e){__privateSet(this,Cs,e);e?__privateGet(this,ii).call(this):__privateGet(this,ni).call(this)}get accessToken(){return __privateGet(this,Ps)||je.accessToken}set accessToken(e){__privateSet(this,Ps,e)}get feature(){return __privateGet(this,Ws)}set feature(e){__privateSet(this,Ws,e);e?this.show():this.hide()}get template(){return Ms}get templateStyle(){return se}get templateUserStyle(){return getThemeCSS(".MapboxAddressMinimap",this.theme)}get satelliteToggle(){return __privateGet(this,$s)}set satelliteToggle(e){__privateSet(this,$s,e);e?__privateGet(this,ri).call(this):__privateGet(this,ai).call(this)}get theme(){return __privateGet(this,Rs)}set theme(e){__privateSet(this,Rs,e);if(!__privateGet(this,js)||!e)return;this.updateTemplateUserStyle(getThemeCSS(".MapboxAddressMinimap",e));const{Marker:t,MapStyleToggle:s}=__privateGet(this,js);t.innerHTML=getIcon("marker",e);s&&(s.style.backgroundImage=__privateGet(this,ti).call(this,"default"===this.mapStyleMode?"satellite":"default"))}get adjustBtnText(){return __privateGet(this,_s)||xs}set adjustBtnText(e){__privateSet(this,_s,e);const t=this.querySelector(".MinimapButtonAdjust");t.textContent=e||xs}get saveBtnText(){return __privateGet(this,Hs)||Ss}set saveBtnText(e){__privateSet(this,Hs,e);const t=this.querySelector(".MinimapButtonSave");t.textContent=e||Ss}get cancelBtnText(){return __privateGet(this,zs)||As}set cancelBtnText(e){__privateSet(this,zs,e);const t=this.querySelector(".MinimapButtonCancel");t.textContent=e||As}get mapStyleMode(){return __privateGet(this,Ds)}set mapStyleMode(e){const t=__privateGet(this,Ds);if(t===e)return;__privateSet(this,Ds,e);if(!__privateGet(this,js))return;const{MapStyleToggle:s}=__privateGet(this,js);if(s){s.style.backgroundImage=__privateGet(this,ti).call(this,t);s.setAttribute("title","Switch to "+("satellite"===t?"Satellite":"Default"));__privateGet(this,ei).call(this)}}get defaultMapStyle(){return __privateGet(this,qs)}set defaultMapStyle(e){__privateSet(this,qs,e);__privateGet(this,ei).call(this)}get footer(){return __privateGet(this,Vs)}set footer(e){__privateSet(this,Vs,e);const t=this.querySelector(".MinimapFooter");if(t)if("string"===typeof e){t.textContent=e;t.removeAttribute("aria-hidden")}else e?t.removeAttribute("aria-hidden"):t.setAttribute("aria-hidden","true")}get container(){return __privateGet(this,Ns)}set container(e){if(e){e.style.position="relative";__privateSet(this,Ns,e)}}show(){if(!__privateGet(this,Ws))return;const e=__privateGet(this,Ws).geometry.coordinates;__privateGet(this,Os).coordinate=e;__privateSet(this,Ls,__privateGet(this,Gs).call(this,e));const{MapboxAddressMinimap:t,Image:s}=__privateGet(this,js);s.src=__privateGet(this,Ls);t.removeAttribute("aria-hidden")}hide(){const{MapboxAddressMinimap:e}=__privateGet(this,js);e.setAttribute("aria-hidden","true")}connectedCallback(){super.connectedCallback();__privateSet(this,js,bindElements(this,{MapboxAddressMinimap:".MapboxAddressMinimap",ImageContainer:".MinimapImageContainer",Image:".MinimapImage",Marker:".MinimapMarker",MapStyleToggle:".MinimapStyleToggle",EditButtons:".MinimapEditButtons",ButtonAdjust:".MinimapButtonAdjust",ButtonSave:".MinimapButtonSave",ButtonCancel:".MinimapButtonCancel"}));this.mapStyleMode=__privateGet(this,Ds);this.theme=__spreadValues({},this.theme);this.canAdjustMarker&&__privateGet(this,ii).call(this);this.satelliteToggle&&__privateGet(this,ri).call(this);this.container=this.parentElement;const e=new ResizeObserver(__privateGet(this,si));e.observe(this.container);__privateGet(this,si).call(this);const{MapboxAddressMinimap:t,ImageContainer:s,Image:i,Marker:n}=__privateGet(this,js);__privateSet(this,Os,new gs(s,i,n,this.keepMarkerCentered,ws,this.markerAnchor));__privateGet(this,Os).reCenter();i.onload=__privateGet(this,Js);i.onerror=__privateGet(this,Ks);i.src=__privateGet(this,Ls);__privateGet(this,Ws)?t.removeAttribute("aria-hidden"):t.setAttribute("aria-hidden","true")}attributeChangedCallback(e,t,s){if("access-token"===e)this.accessToken=s;else if("can-adjust-marker"===e)this.canAdjustMarker="true"===s;else if("keep-marker-centered"===e)this.keepMarkerCentered="true"===s;else if("marker-anchor"===e){const e=s;this.markerAnchor=e;__privateGet(this,Os)&&(__privateGet(this,Os).anchor=e)}else"satellite-toggle"===e&&(this.satelliteToggle="true"===s)}};Cs=new WeakMap;Ts=new WeakMap;Bs=new WeakMap;Ws=new WeakMap;Ls=new WeakMap;Is=new WeakMap;Fs=new WeakMap;js=new WeakMap;Os=new WeakMap;Ps=new WeakMap;Rs=new WeakMap;$s=new WeakMap;Ds=new WeakMap;_s=new WeakMap;Hs=new WeakMap;zs=new WeakMap;qs=new WeakMap;Vs=new WeakMap;Ns=new WeakMap;Ys=new WeakMap;Xs=new WeakMap;Us=new WeakMap;Zs=new WeakMap;Qs=new WeakMap;Js=new WeakMap;Ks=new WeakMap;Gs=new WeakMap;ei=new WeakMap;ti=new WeakMap;si=new WeakMap;ii=new WeakMap;ni=new WeakMap;ri=new WeakMap;ai=new WeakMap;oi.observedAttributes=["access-token","can-adjust-marker","keep-marker-centered","marker-anchor","satellite-toggle"];window.MapboxAddressMinimap=oi;window.customElements.get("mapbox-address-minimap")||customElements.define("mapbox-address-minimap",oi);var li,hi,ci,di,ui,pi,mi,vi,fi,gi,bi;var wi=class{constructor(e,t,s){__privateAdd(this,li,void 0);__privateAdd(this,hi,void 0);__privateAdd(this,ci,void 0);this.options={};this.retrieveFeature=null;this.listbox=new Ee;__privateAdd(this,di,void 0);__privateAdd(this,ui,(e=>{const t=e.detail;const s=true===__privateGet(this,hi).browserAutofillEnabled&&(null==t?void 0:t.length)<=2;toggleAutocompletion(__privateGet(this,li),__privateGet(this,di),s);(null==t?void 0:t.length)<=2?this.listbox.handleSuggest(null):__privateGet(this,ci).suggest(t,this.options)}));__privateAdd(this,pi,(e=>{const t=e.detail;if("street"!==e.detail.accuracy){toggleAutocompletion(__privateGet(this,li),__privateGet(this,di),true);__privateGet(this,ci).retrieve(t,this.options)}else handleStreetSelection(__privateGet(this,li),__privateGet(this,di),t)}));__privateAdd(this,mi,(()=>{toggleAutocompletion(__privateGet(this,li),__privateGet(this,di),true);__privateGet(this,ci).abort()}));__privateAdd(this,vi,(()=>{var e;const t=true===__privateGet(this,hi).browserAutofillEnabled&&(null==(e=__privateGet(this,li).value)?void 0:e.length)<=2;toggleAutocompletion(__privateGet(this,li),__privateGet(this,di),t)}));__privateAdd(this,fi,(e=>{const t=(null==e?void 0:e.suggestions)?distinctExactStreetResults(e.suggestions):null;this.listbox.handleSuggest(t);const s=new ie("suggest",e);Object.defineProperty(s,"target",{value:__privateGet(this,li)});__privateGet(this,hi).fire("suggest",s)}));__privateAdd(this,gi,(e=>{this.listbox.handleError();const t=new ie("suggesterror",e);Object.defineProperty(t,"target",{value:__privateGet(this,li)});__privateGet(this,hi).fire("suggesterror",t)}));__privateAdd(this,bi,(e=>{var t;const s=new ie("retrieve",e);Object.defineProperty(s,"target",{value:__privateGet(this,li)});__privateGet(this,hi).fire("retrieve",s);this.retrieveFeature=null==(t=e.features)?void 0:t[0];if(!__privateGet(this,li))return;const i=e;i&&i.features&&i.features.length&&fillFormWithFeature(i.features[0],__privateGet(this,li))}));__privateSet(this,li,t);__privateSet(this,hi,e);__privateSet(this,ci,new a(s));__privateGet(this,ci).sessionToken=je.autofillSessionToken;this.listbox.input=__privateGet(this,li);this.listbox.autofillHost=this;this.listbox.searchService=0;this.listbox.addEventListener("input",__privateGet(this,ui));this.listbox.addEventListener("select",__privateGet(this,pi));this.listbox.addEventListener("blur",__privateGet(this,mi));this.listbox.addEventListener("focus",__privateGet(this,vi));__privateGet(this,ci).addEventListener("suggest",__privateGet(this,fi));__privateGet(this,ci).addEventListener("suggesterror",__privateGet(this,gi));__privateGet(this,ci).addEventListener("retrieve",__privateGet(this,bi));document.body.appendChild(this.listbox);if(t){t.insertAdjacentElement("beforebegin",createAriaLiveElement(this.listbox.dataSeed));suppressExtensionsAutocomplete(t);__privateSet(this,di,t.autocomplete)}}get input(){return __privateGet(this,li)}remove(){this.listbox.remove();this.listbox.removeEventListener("input",__privateGet(this,ui));this.listbox.removeEventListener("select",__privateGet(this,pi));this.listbox.removeEventListener("blur",__privateGet(this,mi));this.listbox.removeEventListener("focus",__privateGet(this,vi));__privateGet(this,ci).removeEventListener("suggest",__privateGet(this,fi));__privateGet(this,ci).removeEventListener("suggesterror",__privateGet(this,gi));__privateGet(this,ci).removeEventListener("retrieve",__privateGet(this,bi))}simulateRetrieve(e){const t=__privateGet(this,li);t&&(t.dataset.mapboxSuccess="true");this.listbox.hideResults();const s={type:"FeatureCollection",features:[e],url:""};__privateGet(this,bi).call(this,s)}};li=new WeakMap;hi=new WeakMap;ci=new WeakMap;di=new WeakMap;ui=new WeakMap;pi=new WeakMap;mi=new WeakMap;vi=new WeakMap;fi=new WeakMap;gi=new WeakMap;bi=new WeakMap;var Mi,ki,yi,xi,Si,Ai,Ei,Ci;var Ti=class extends c{constructor({accessToken:e,options:t,theme:s,popoverOptions:i,confirmOnBrowserAutofill:n,browserAutofillEnabled:a}){super();this.instances=[];__privateAdd(this,Mi,void 0);__privateAdd(this,ki,new r);__privateAdd(this,yi,void 0);__privateAdd(this,xi,void 0);__privateAdd(this,Si,void 0);this.confirmOnBrowserAutofill=false;this.browserAutofillEnabled=false;__privateAdd(this,Ai,(()=>{deepEquals(findAddressInputs(),__privateGet(this,Mi))||this.update()}));__privateAdd(this,Ei,new MutationObserver(__privateGet(this,Ai)));__privateAdd(this,Ci,(e=>__async(this,null,(function*(){this.instances.forEach((e=>e.listbox.blur()));for(const t of this.instances){const s=t.listbox.input;yield tryConfirmBrowserAutofill(s,e,this.confirmOnBrowserAutofill,this.accessToken)}}))));initDetectBrowserAutofill();window.addEventListener("browserautofill",__privateGet(this,Ci));je.autofillSessionEnabled=true;this.accessToken=e||je.accessToken;t&&(this.options=t);s&&(this.theme=s);i&&(this.popoverOptions=i);n&&(this.confirmOnBrowserAutofill=n);a&&(this.browserAutofillEnabled=a);this.update()}get accessToken(){return __privateGet(this,ki).accessToken}set accessToken(e){__privateGet(this,ki).accessToken=e}get options(){return __privateGet(this,yi)}set options(e){__privateSet(this,yi,__spreadValues(__spreadValues({},__privateGet(this,yi)),e));this.instances.forEach((t=>{t.options=__spreadValues(__spreadValues({},t.options),e)}))}get theme(){return __privateGet(this,xi)}set theme(e){__privateSet(this,xi,e);this.instances.forEach((t=>{t.listbox.theme=e}))}get popoverOptions(){return __privateGet(this,Si)}set popoverOptions(e){__privateSet(this,Si,e);this.instances.forEach((t=>{t.listbox.popoverOptions=e}))}update(){this.instances.forEach((e=>{e.remove()}));__privateSet(this,Mi,findAddressInputs());this.instances=[];__privateGet(this,Mi).forEach((e=>{const t=new wi(this,e,__privateGet(this,ki));t.options=this.options;t.listbox.theme=this.theme;t.listbox.popoverOptions=this.popoverOptions;this.instances.push(t)}))}observe(){__privateGet(this,Ei).observe(document,{subtree:true,childList:true});__privateGet(this,Ai).call(this)}unobserve(){__privateGet(this,Ei).disconnect()}remove(){this.instances.forEach((e=>{e.remove()}));this.unobserve();window.removeEventListener("browserautofill",__privateGet(this,Ci))}};Mi=new WeakMap;ki=new WeakMap;yi=new WeakMap;xi=new WeakMap;Si=new WeakMap;Ai=new WeakMap;Ei=new WeakMap;Ci=new WeakMap;function autofill(e){return new Ti(e)}export{Bt as MapboxAddressAutofill,_e as MapboxAddressConfirmation,oi as MapboxAddressMinimap,ie as MapboxHTMLEvent,es as MapboxSearchBox,autofill,je as config,confirmAddress,getAutofillSearchText,getFormAutofillValues};

